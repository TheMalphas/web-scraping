var catalogo=angular.module("catalogo",["ui.router","ngMeta","ngResource","ngNotify","angular-loading-bar","hl.sticky","ngAnimate","ngSanitize","duScroll","LocalStorageModule","bootcomplete"]).config(["$httpProvider","$stateProvider","$urlRouterProvider","$locationProvider","ngMetaProvider","cfpLoadingBarProvider","localStorageServiceProvider",function(e,n,o,i,t,a,r){var c={fromQueryString:!1,value:"it"};n.state("home",{url:"/",component:"home"}).state("sitemap.xml",{url:"/siteMapSiteImprove.xml"}).state("corsi",{url:"/corsi/:anno?gruppo&area&sede&dipartimento&lingua&searchString&filter",params:{gruppo:{dynamic:!0,inherit:!1},area:{dynamic:!0,inherit:!1},sede:{dynamic:!0,inherit:!1},dipartimento:{dynamic:!0,inherit:!1},lingua:{dynamic:!0,inherit:!1},searchString:{dynamic:!0,inherit:!1},filter:{dynamic:!0,inherit:!1}},component:"corsi"}).state("corso",{url:"/corsi/:anno/:corso?annoOrdinamento",params:{annoOrdinamento:{dynamic:!0,inherit:!1}},component:"corso"}).state("corso-code",{url:"/corsi-code/:anno/:corsoCod",controller:["STATEPARAMS","CORSO_CODE","$location","$state","$rootScope",function(e,n,o,i,t){var a=e.get(),r=a.anno;if(o.search().grafica)var c=o.search().grafica;var s=t.ateneo.aa;r>s[0].value&&(r=s[0].value);var l={anno:r,cdsCod:decodeURIComponent(a.corsoCod),grafica:c};n.get(l,function(e){if(e){var n="/corsi/"+r+"/"+e.cod;o.path(n)}else i.go("paginaNonRaggiungibile",{urlSbagliato:o.absUrl()})},function(e){i.go("paginaNonRaggiungibile",{urlSbagliato:o.absUrl()})})}]}).state("corso-code-insegnamenti",{url:"/corsi-code/:anno/:corsoCod/insegnamenti/:pdsCod?schemacod",controller:["STATEPARAMS","CORSO_CODE","$location","$state","$rootScope",function(e,n,o,i,t){var a=e.get(),r=a.anno;if(o.search().grafica)var c=o.search().grafica;var s=t.ateneo.aa;r>s[0].value&&(r=s[0].value);var l={anno:r,cdsCod:decodeURIComponent(a.corsoCod),grafica:c};n.get(l,function(e){if(e){var n=_.find(e.percorsi,function(e){return e.pdsCod===decodeURIComponent(a.pdsCod)&&(!o.search().schemacod||decodeURIComponent(o.search().schemacod)===_.toString(e.schemaCod))});if(n){var t=`/corsi/${r}/${e.cod}/insegnamenti/${n.pdsId}`,c={};n.schemaId&&(c.schemaid=n.schemaId),o.path(t).search(c)}else i.go("paginaNonRaggiungibile",{urlSbagliato:o.absUrl()})}else i.go("paginaNonRaggiungibile",{urlSbagliato:o.absUrl()})},function(e){i.go("paginaNonRaggiungibile",{urlSbagliato:o.absUrl()})})}]}).state("corso.insegnamenti",{url:"/insegnamenti/:percorso?schemaid",component:"corsoInsegnamenti",params:{percorso:{value:null,squash:!0},schemaid:{value:null,squash:!0}}}).state("corso.insegnamenti-offerta",{url:"/insegnamenti-offerta",controller:["STATEPARAMS","CORSO","$location",function(e,n,o){var i=e.get();n.get({anno:i.anno,corso:i.corso},function(e){if(e.percorsi&&e.percorsi.length>0){let t=_.find(e.percorsi,function(e){return _.find(e.anni,function(e){return e.attivita})});var n=_.find(t.anni,function(e){return e.attivita}).attivita[0].af_percorso_id,i="/corsi/"+e.aa+"/"+e.cod+"/insegnamenti/"+n;o.path(i)}})}]}).state("docente",{url:"/docente/:docente/:anno",component:"docente"}).state("insegnamento",{url:"/insegnamenti/:anno/:insegnamento/:ordinamento_aa/:af_percorso/:corso_cod?coorte&schemaid",component:"insegnamento",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}}}).state("insegnamento-coorte",{url:"/insegnamenti/:anno/:insegnamento/:ordinamento_aa/:af_percorso/:corso_cod/:coorte",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}},controller:["STATEPARAMS","$location",function(e,n){var o=e.get(),i="/insegnamenti/"+o.anno+"/"+encodeURIComponent(o.insegnamento)+"/"+o.ordinamento_aa+"/"+encodeURIComponent(o.af_percorso)+"/"+encodeURIComponent(o.corso_cod);n.path(i).search({coorte:o.coorte})}]}).state("attivita-formativa",{url:"/af/:aaOfferta?corso&annoOrdinamento&pds&coorte&piano&ad&ud&domPart",controller:["STATEPARAMS","ATTIVITA_FORMATIVA","CORSO_CODE","$location","$state","$timeout","$rootScope","localStorageService",function(e,n,o,i,t,a,r,c){i.search().coorte&&c.set("year",i.search().coorte);var s=function(e,n){var c=e,s=r.ateneo.aa;c>s[0].value&&(c=s[0].value);var l={anno:c,cdsCod:n};o.get(l,function(e){e?(t.go("paginaNonRaggiungibile",{urlSbagliatoRedirect:i.absUrl()}),a(function(){t.go("corso",{anno:e.aa,corso:e.cdsId})},3e3)):t.go("paginaNonRaggiungibile",{urlSbagliato:i.absUrl()})},function(e){t.go("paginaNonRaggiungibile",{urlSbagliato:i.absUrl()})})},l=e.get();if(i.search().grafica)var d=i.search().grafica;if(i.search().corso&&i.search().annoOrdinamento&&i.search().pds&&i.search().ad){var u={aa:l.aaOfferta,cdsCod:i.search().corso,ordinamento_aa:i.search().annoOrdinamento,af_percorso_cod:i.search().pds,adCod:i.search().ad,grafica:d};i.search().coorte&&(u.corso_aa=i.search().coorte),i.search().piano&&(u.schemaCod=i.search().piano),i.search().ud&&(u.udCod=i.search().ud),i.search().domPart&&(u.domPartCod=i.search().domPart),n.get(u,function(e){if(e){var n={coorte:e.corso_aa};e.schemaId&&(n.schemaid=e.schemaId);var o="/insegnamenti/"+e.aa+"/"+encodeURIComponent(e.cod)+"/"+e.ordinamento_aa+"/"+encodeURIComponent(e.af_percorso_id)+"/"+encodeURIComponent(e.corso_cod);i.path(o).search(n)}else u.corso_aa&&u.cdsCod?s(u.corso_aa,u.cdsCod):t.go("paginaNonRaggiungibile",{urlSbagliato:i.absUrl()})},function(e){u.corso_aa&&u.cdsCod?s(u.corso_aa,u.cdsCod):t.go("paginaNonRaggiungibile",{urlSbagliato:i.absUrl()})})}else i.search().coorte&&i.search().corso?s(i.search().coorte,i.search().corso):t.go("paginaNonRaggiungibile",{urlSbagliato:i.absUrl()})}]}).state("insegnamento-code",{url:"/insegnamenti-code/:aa_offerta/:cod_af/:aa_ordinamento/:af_percorso/:cod_corso?coorte&schemaid",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}},controller:["STATEPARAMS","INSEGNAMENTO_CODE","$location",function(e,n,o){var i=e.get();if(o.search().grafica)var t=o.search().grafica;var a={aa_offerta:i.aa_offerta,cod_af:decodeURIComponent(i.cod_af),aa_ordinamento:i.aa_ordinamento,af_percorso:decodeURIComponent(i.af_percorso),cod_corso:decodeURIComponent(i.cod_corso),grafica:t};o.search().coorte&&(a.corso_aa=o.search().coorte),o.search().schemaid&&(a.schema_id=o.search().schemaid),n.get(a,function(e){var n={coorte:e.corso_aa};e.schemaId&&(n.schemaid=e.schemaId);var i="/insegnamenti/"+e.aa+"/"+encodeURIComponent(e.cod)+"/"+e.ordinamento_aa+"/"+encodeURIComponent(e.af_percorso_id)+"/"+encodeURIComponent(e.corso_cod);o.path(i).search(n)})}]}).state("insegnamento-code-coorte",{url:"/insegnamenti-code/:aa_offerta/:cod_af/:aa_ordinamento/:af_percorso/:cod_corso/:coorte",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}},controller:["STATEPARAMS","$location",function(e,n){var o=e.get(),i="/insegnamenti-code/"+o.aa_offerta+"/"+encodeURIComponent(o.cod_af)+"/"+o.aa_ordinamento+"/"+encodeURIComponent(o.af_percorso)+"/"+encodeURIComponent(o.cod_corso);n.path(i).search({coorte:o.coorte})}]}).state("insegnamento-offerta",{url:"/insegnamenti-offerta/:anno/:insegnamento/:ordinamento_aa/:id_pds/:corso_cod",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}},controller:["STATEPARAMS","INSEGNAMENTO_OFFERTA","$location",function(e,n,o){var i=e.get();if(o.search().grafica)var t=o.search().grafica;n.get({anno:i.anno,insegnamento:i.insegnamento,ordinamento_aa:i.ordinamento_aa,id_pds:i.id_pds,corso_cod:i.corso_cod,grafica:t},function(e){var n="/insegnamenti/"+e.aa+"/"+e.cod+"/"+e.ordinamento_aa+"/"+e.af_percorso_id+"/"+e.corso_cod+"/"+e.corso_aa;o.path(n)})}]}).state("insegnamento-offerta-code",{url:"/insegnamenti-offerta-code/:aa_offerta/:cod_af/:aa_ordinamento/:cod_pds/:cod_corso",params:{modulo:{value:null,squash:!0},partizione:{value:null,squash:!0}},controller:["STATEPARAMS","INSEGNAMENTO_OFFERTA_CODE","$location",function(e,n,o){var i=e.get();if(o.search().grafica)var t=o.search().grafica;n.get({aa_offerta:i.aa_offerta,cod_af:i.cod_af,aa_ordinamento:i.aa_ordinamento,cod_pds:i.cod_pds,cod_corso:i.cod_corso,grafica:t},function(e){var n="/insegnamenti/"+e.aa+"/"+e.cod+"/"+e.ordinamento_aa+"/"+e.af_percorso_id+"/"+e.corso_cod+"/"+e.corso_aa;o.path(n)})}]}).state("cercaInsegnamenti",{url:"/cerca-insegnamenti",component:"cercaInsegnamenti"}).state("cercaDocenti",{url:"/cerca-docenti",component:"cercaDocenti"}).state("cercaCorsi",{url:"/cerca-corsi",component:"cercaCorsi"}).state("cercaOfferta",{url:"/cerca-offerta",component:"cercaOfferta"}).state("cookieLaw",{url:"/cookie-law",component:"cookieLaw"}).state("lista-docenti",{url:"/lista-docenti/:anno/:ordinamento_aa/:corso_cod",component:"listaDocenti"}).state("paginaNonRaggiungibile",{url:"/error?urlSbagliato&urlSbagliatoRedirect",component:"paginaNonRaggiungibile",params:{urlSbagliato:null,urlSbagliatoRedirect:null}}),i.html5Mode(!0),o.otherwise("/"),a.includeSpinner=!1,t.useTitleSuffix(!0),r.setDefaultToCookie(!1),e.interceptors.push(["$q","$injector","$rootScope",function(e,n,o){return{responseError:function(o){var i=n.get("ngNotify");return 500===o.status&&i.set("Ops qualcosa è andato storto",{sticky:!0,type:"error"}),e.reject(o)}}}]),e.interceptors.push(["localStorageService","$location","$rootScope",function(e,n,o){return{request:function(i){if(n.search().linguaCC){var t=n.search().linguaCC;if("IT"===t||"EN"===t){var a=t.toLowerCase();c.fromQueryString=!0}else a="it";e.set("lang",a)}else a=e.get("lang")||"it";return c.value=a,o.langToken=c,i.headers.lang=a,i}}}])}]).run(["$rootScope","ngMeta",function(e,n){n.init(),e.$on("$locationChangeStart",function(n,o,i){e.$emit("modal-close")})}]).run(["$rootScope","$location",function(e,n){e.$on("$locationChangeSuccess",function(){e.actualLocation=n.path()}),e.$watch(function(){return n.path()},function(n,o){e.oldLocation=o,e.actualLocation===n&&e.$emit("browser-back")})}]).constant("CONST",{obiettiviAgenda2030:{icon01_it:"Povertà zero",icon01_en:"No poverty",icon02_it:"Fame zero",icon02_en:"Zero hunger",icon03_it:"Salute e benessere",icon03_en:"Good health and well-being",icon04_it:"Istruzione di qualità",icon04_en:"Quality education",icon05_it:"Uguaglianza di genere",icon05_en:"Gender equality",icon06_it:"Acqua pulita e igiene",icon06_en:"Clean water and sanitation",icon07_it:"Energia pulita e accessibile",icon07_en:"Affordable and clean energy",icon08_it:"Lavoro dignitoso e crescita economica",icon08_en:"Decent work and economy growth",icon09_it:"Industria, innovazione e infrastrutture",icon09_en:"Industries, innovation and infrastructure",icon10_it:"Ridurre le disuguaglianze",icon10_en:"Reduced inequalities",icon11_it:"Città e comunità sostenibili",icon11_en:"Sustainable cities and communities",icon12_it:"Consumo e produzione responsabili",icon12_en:"Responsible consumption and production",icon13_it:"Agire per il clima",icon13_en:"Climate action",icon14_it:"La vita sott'acqua",icon14_en:"Life below water",icon15_it:"La vita sulla terra",icon15_en:"Life and land",icon16_it:"Pace, giustizia e istituzioni forti",icon16_en:"Peace, justice and strong institutions",icon17_it:"Partnership per gli obiettivi",icon17_en:"Partnership for the goals"}}).run(["$rootScope","CONST",function(e,n){e.CONST=n}]).component("app",{templateUrl:"html/components/app.html",controller:["$rootScope","$timeout","$state","localStorageService","$location","ATENEO","LOCALIZE","CONFIGURAZIONE","STATEPARAMS",function(e,n,o,i,t,a,r,c,s){var l=this;this.localize=function(){r.object(e.ateneo.i18n),r.collection(e.ateneo.link),this.i18n=e.ateneo.i18n},c.getConfig(function(e){if(e&&e.BASE_URL_IU&&""!==e.BASE_URL_IU){var n=document.createElement("script");n.src=`https://${e.BASE_URL_IU}/iandu-listener.js`,n.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(n)}if(e&&e.ENV&&("dev"===e.ENV||"test"===e.ENV)){var o=document.createElement("div");o.classList.add("banner"),o.innerHTML="dev"===e.ENV?"Ambiente di dev":"Ambiente di test",document.getElementById("top").appendChild(o)}}),this.$onInit=function(){document.body.style.visibility="hidden",l.state=o,this.ateneo=a.get(function(o){e.ateneo=o,e.linkIandU="https://static.dev.iu.cineca.it/iandu-listener.js",l.localize(),n(function(){document.body.style.visibility="visible",e.langToken.fromQueryString&&(l.state.params.linguaCC=e.langToken.value),e.lang=e.langToken.value,e.$emit("lang-changed",e.langToken.value)},200)})},this.$onDestroy=function(){d()};let d=e.$on("lang-changed",function(n,t){e.lang=t;var a=s.get();a.linguaCC&&(a.linguaCC=t.toUpperCase(),o.go(o.current,a,{reload:!0})),i.set("lang",t),l.localize()});this.cookie=!0,this.chiudiCookie=function(){this.cookie=!1},this.salvaCookie=function(){let e=new Date,n=new Date(e.setMonth(e.getMonth()+6));i.set("cookie_consent",!0),i.set("cookie_consent_expire",n),this.cookie=!1},this.consent=i.get("cookie_consent"),this.consentExpired=i.get("cookie_consent_expire"),new Date>new Date(this.consentExpired)&&(i.remove("cookie_consent_expire"),this.cookie=!0),this.consent&&this.consentExpired&&(this.cookie=!1),this.mostraGrafica=!0,t.search().grafica&&"off"==t.search().grafica&&(this.mostraGrafica=!1)}]}).directive("backImg",["$http",function(e){return function(n,o,i){i.$observe("backImg",function(n){e.get(n).then(function(e){e.data.startsWith("<!DOCTYPE")||o.css({"background-image":"url("+n+")","background-repeat":"no-repeat","background-size":"contain","background-position":"center"})}).catch(function(e){console.log(e)})})}}]);catalogo.service("CONFIGURAZIONE",["$resource",function(e){return e("/api/configurazione",{},{getConfig:{method:"GET"}})}]).service("ATENEO",["$resource",function(e){return e("/api/v1/ateneo")}]).service("ANNI_OFFERTA",["$resource",function(e){return e("/api/v1/anni-offerta/")}]).service("AREE",["$resource",function(e){return e("/api/v1/aree/:anno")}]).service("GRUPPI",["$resource",function(e){return e("/api/v1/gruppi/:anno")}]).service("CORSI",["$resource",function(e){return e("/api/v1/corsi")}]).service("CORSO",["$resource",function(e){return e("/api/v1/corso/:anno/:corso")}]).service("CORSO_CODE",["$resource",function(e){return e("/api/v1/corso-code")}]).service("INSEGNAMENTO",["$resource",function(e){return e("/api/v1/insegnamento")}]).service("INSEGNAMENTO_CODE",["$resource",function(e){return e("/api/v1/insegnamento-code")}]).service("ATTIVITA_FORMATIVA",["$resource",function(e){return e("/api/v1/attivitaFormativa")}]).service("INSEGNAMENTO_OFFERTA",["$resource",function(e){return e("/api/v1/insegnamento-offerta/:anno/:insegnamento/:ordinamento_aa/:id_pds/:corso_cod")}]).service("INSEGNAMENTO_OFFERTA_CODE",["$resource",function(e){return e("/api/v1/insegnamento-offerta-code/:aa_offerta/:cod_af/:aa_ordinamento/:cod_pds/:cod_corso")}]).service("DOCENTE",["$resource",function(e){return e("/api/v1/docente/:docente/:anno")}]).service("LISTA_DOCENTI",["$resource",function(e){return e("/api/v1/lista-docenti/:anno/:ordinamento_aa/:corso_cod")}]).service("CREA_PDF",["$resource","$http",function(e,n){var o={create:function(e,o,i){delete i.queries;var t={method:"post",headers:{"content-type":"application/json; charset=utf-8",Authorization:"reportBasicAuth",Accept:"application/pdf"},responseType:"arraybuffer",url:"/api/v1/crea_pdf",data:{template:o,json:escape(JSON.stringify(i))}};n(t).then(function(n){var o=new Uint8Array(n.data),i=new Blob([o],{type:"application/pdf"});saveAs(i,e)},function(e){console.log(e)})}};return o}]).service("CALENDARIO_UP",["$resource",function(e){return e("/api/calendarioPubblicoUP",{},{calendarioPubblicoUP:{method:"POST",url:"/api/v1/calendarioPubblicoUP/"}})}]).service("RICERCA",["$resource",function(e){return e("/api/v1/ricerca/",{},{ricercaAreeTendina:{method:"GET",isArray:!0,url:"/api/v1/ricerca/aree/:anno"},ricercaGruppiTendina:{method:"GET",isArray:!0,url:"/api/v1/ricerca/gruppi/:anno"},ricercaSediTendina:{method:"GET",isArray:!0,url:"/api/v1/ricerca/sedi/:anno"},ricercaLingueTendina:{method:"GET",isArray:!0,url:"/api/v1/ricerca/lingue/:anno"},ricercaDipartimentiTendina:{method:"GET",isArray:!0,url:"/api/v1/ricerca/dipartimenti/:anno"},ricercaCorsiTendina:{method:"POST",isArray:!0,url:"/api/v1/ricerca/corsiTendina"},ricercaSsdTendina:{method:"POST",isArray:!0,url:"/api/v1/ricerca/ssdTendina"},cercaCorsi:{method:"POST",isArray:!0,url:"/api/v1/ricerca/corsi"},cercaInsegnamenti:{method:"POST",isArray:!0,url:"/api/v1/ricerca/insegnamenti"},cercaDocenti:{method:"POST",isArray:!0,url:"/api/v1/ricerca/docenti"},cercaOfferta:{method:"POST",isArray:!0,url:"/api/v1/ricerca/offerta"}})}]).service("STATEPARAMS",["$stateParams",function(e){var n={get:function(){return _.omit(_.omitBy(e,_.isNil),"$inherit")}};return n}]).service("META",["ngMeta","$rootScope",function(e,n){var o={setTitle:function(o){e.setTitle(o+" | "+n.ateneo.des)}};return o}]).service("LOCALIZE",["localStorageService",function(e){var n={},o=function(){return"_"+e.get("lang")};return n.collection=function(e){try{e&&e.forEach(function(e){Object.keys(e).forEach(function(n){-1!==n.indexOf(o())&&(e[n.replace(o(),"")]=e[n])})})}catch(n){console.log(n,e)}return e},n.object=function(n){try{Object.keys(n).forEach(function(i){-1!=i.indexOf(o())&&(n[i.replace(o(),"")]=n[i],"en"!==e.get("lang")||""!==n[i]&&" "!==n[i]||(n[i]=n[i.replace(o(),"_it")]))})}catch(e){console.log(e)}return n},n.lang=function(){return e.get("lang")},n}]),catalogo.component("accordion",{templateUrl:"html/components/accordion.html",bindings:{items:"="}}),catalogo.component("cardHome",{templateUrl:"html/components/card-home.html",bindings:{color:"<",header:"<",description:"<",footerRight:"<",footerLeft:"<"},controller:[function(){var e=this;e.$onInit=function(){e.color&&(e.style={background:e.color})}}]}),catalogo.component("cardInsegnamento",{templateUrl:"html/components/card-insegnamento.html",bindings:{labels:"=",insegnamento:"<",codice:"<",anno:"<",cfu:"<",ore:"<",moduli:"=",ordinamentoaa:"<",corsocod:"<",afpercorsoid:"<",afpercorsocod:"<",schemaid:"<",soloAttiveFlg:"<",statoOffertaAttivo:"<",adPadre:"=",adFiglie:"=",corsoOfferta:"=",corsoRaggruppato:"=",titolare:"<",periododidattico:"<",cardinsegnamento:"=",tipoinscod:"<",tipoinsdes:"<",insegnamentoerogato:"<",annoImmatricolazione:"<",insegnamentoObbligatorio:"<"},controller:["$rootScope","$location","LOCALIZE",function(e,n,o){var i=this,t=function(e){return isNaN(parseInt(e))?e:e+"/"+(parseInt(e)+1)};i.docenti_fittizi=e.ateneo.docenti_fittizi&&""!=e.ateneo.docenti_fittizi?e.ateneo.docenti_fittizi.split(",").map(function(e){return e.trim()}):[],i.$onInit=function(){i.isPadre=!!(i.adFiglie&&i.adFiglie.length>0&&_.some(i.adFiglie,function(e){return e.aaOffId===i.anno})),i.isFiglia=!(!i.adPadre||!i.adPadre.adCod||i.adPadre.aaOffId!==i.anno),i.visualizzaTitolare=_.find(i.cardinsegnamento,function(e){return"visualizzaTitolareCard"===e.nomeCampo}),i.visualizzaCfu=_.find(i.cardinsegnamento,function(e){return"visualizzaCfuCard"===e.nomeCampo}),i.visualizzaOre=_.find(i.cardinsegnamento,function(e){return"visualizzaOreCard"===e.nomeCampo}),i.visualizzaPeriodo=_.find(i.cardinsegnamento,function(e){return"visualizzaPeriodoDidattico"===e.nomeCampo}),i.visualizzaTipoInsegnamento=_.find(i.cardinsegnamento,function(e){return"visualizzaTipoInsegnamento"===e.nomeCampo}),i.annoOffertaCompleto=t(i.anno),i.cfu=parseFloat(i.cfu),i.titolare=i.titolare&&i.titolare.matricola&&!i.docenti_fittizi.includes(i.titolare.matricola)?i.titolare:null,_.forEach(i.adFiglie,function(e){e.annoOffertaCompleto=t(e.aaOffId)}),n.search().grafica&&(i.grafica=n.search().grafica),i.localizeData()},i.localizeData=function(){i.adFiglie&&o.collection(i.adFiglie),i.adPadre&&o.object(i.adPadre)},i.$onDestroy=function(){a()};let a=e.$on("lang-changed",function(){i.localizeData()})}]}),catalogo.component("cercaCorsi",{templateUrl:"html/components/cerca-corsi.html",controller:["$rootScope","$document","$timeout","$location","META","LOCALIZE","RICERCA",function(e,n,o,i,t,a,r){var c=this;c.no_groups=[],c.params={},c.lang=a.lang(),c.corsiTendina=[],c.$onInit=function(){c.i18n=e.ateneo.i18n,c.smallScreen=window.matchMedia("(max-width: 1023px)").matches,c.tipoHome=e.ateneo.tipo_home,c.data=(new Date).getFullYear(),c.cercaCorso=e.ateneo.ricerca&&e.ateneo.ricerca.cercaCorso?e.ateneo.ricerca.cercaCorso:null,c.mostraCampoSede=!0,c.mostraCampoLingua=!0,c.mostraCampoDipartimento=!0,c.cercaCorso&&(c.mostraCampoSede=_.find(c.cercaCorso,function(e){return"sede"===e.nomeCampo}).visibile,c.mostraCampoLingua=_.find(c.cercaCorso,function(e){return"linguaDiErogazione"===e.nomeCampo}).visibile,c.mostraCampoDipartimento=_.find(c.cercaCorso,function(e){return"dipartimento"===e.nomeCampo}).visibile),c.aree=r.ricercaAreeTendina({anno:e.year.value},function(e){c.aree=a.collection(e,e=>e.count)}),c.gruppi=r.ricercaGruppiTendina({anno:e.year.value},function(e){c.gruppi=a.collection(e)}),c.sedi=r.ricercaSediTendina({anno:e.year.value},function(e){c.sedi=a.collection(e)}),c.lingue=r.ricercaLingueTendina({anno:e.year.value},function(e){c.lingue=a.collection(e)}),c.dipartimenti=r.ricercaDipartimentiTendina({anno:e.year.value},function(e){c.dipartimenti=a.collection(e)}),c.years=e.ateneo.aa,o(function(){c.localizeData()},10),i.search().grafica&&(c.grafica=i.search().grafica)},c.setPageTitle=function(){e.$emit("pageTitle",{title:c.i18n.cercacorso}),t.setTitle(c.i18n.cercacorso)},c.localizeData=function(){c.setPageTitle(),c.corsi&&(a.collection(c.corsi),c.corsi.forEach(function(e){e.subgroups.length&&(a.collection(e.subgroups),e.subgroups.forEach(function(e){e.cds.length&&a.collection(e.cds)}))}))},c.$onDestroy=function(){s(),l()};let s=e.$on("lang-changed",function(){c.lang=a.lang(),c.localizeData()}),l=e.$on("browser-back",function(){c.params=e.params,c.corsi=e.results,c.resolved=!0});c.submit=function(){var i=c.params;e.params=c.params,i.anno=e.year.value,c.no_groups=[],r.cercaCorsi(i,function(i){c.corsi=i,c.localizeData();for(let e of i)for(let n of e.subgroups)for(let e of n.cds)c.no_groups.push(e);e.results=c.corsi,c.smallScreen&&o(function(){var e=angular.element(document.getElementById("risultati-ricerca"));n.scrollToElement(e,50,100)},100)})},c.reset=function(){c.params={},c.corsi=[],c.no_groups=[]},c.aggiornaAnnoHeader=function(n){e.$emit("year-changed-secondary",{check:"cercaCorsi",value:n.aa.toString(),label:n.aa+"/"+(parseInt(n.aa)+1)})}}]}),catalogo.component("cercaDocenti",{templateUrl:"html/components/cerca-docenti.html",controller:["$rootScope","$state","$document","$timeout","$location","META","LOCALIZE","RICERCA",function(e,n,o,i,t,a,r,c){var s=this;s.params={},s.$onInit=function(){s.i18n=e.ateneo.i18n,s.smallScreen=window.matchMedia("(max-width: 1023px)").matches,s.years_off=_.clone(e.ateneo.aa),s.params.anno_off=s.years_off[0].value,i(function(){s.localizeData()},10),t.search().grafica&&(s.grafica=t.search().grafica)},s.setPageTitle=function(){e.$emit("pageTitle",{title:s.i18n.cercadocente}),a.setTitle(s.i18n.cercadocente)},s.localizeData=function(){s.setPageTitle(),s.docenti&&(r.collection(s.docenti),s.docenti.forEach(function(e){e.insegnamenti.length&&r.collection(e.insegnamenti)}))},s.$onDestroy=function(){l(),d()};let l=e.$on("lang-changed",function(){s.localizeData()});s.makeInsegnamentoUrl=function(e,o,i,t,a,r,c){var l={anno:e,insegnamento:o,ordinamento_aa:i,af_percorso:t,corso_cod:a,coorte:r,schemaid:c,grafica:s.grafica};return n.href("insegnamento",l)},s.makeInsegnamentiHtml=function(e){var n="<ul>";return e.forEach(function(e){e.corso_percorso_des?(n+='<li><a href="'+s.makeInsegnamentoUrl(e.aa,e.cod,e.ordinamento_aa,e.af_percorso_id,e.corso_cod,e.corso_aa,e.schemaId)+'"> ['+e.adCod+"] "+e.des+"</a></li><div>"+s.i18n.corso+": "+e.corso_des+", "+s.i18n.anno_di_offerta_sh+": "+e.aa+", "+s.i18n.percorso+": "+e.corso_percorso_des,"altreAttivita"===e.corso_anno?n+=" </div>":n+=" ("+e.corso_anno+"° "+s.i18n.anno+" , coorte: "+e.corso_aa+")</div>"):n+='<li><a href="'+s.makeInsegnamentoUrl(e.aa,e.cod,e.ordinamento_aa,e.af_percorso_id,e.corso_cod,e.corso_aa,e.schemaId)+'"> ['+e.adCod+"] "+e.des+"</a></li><div>"+s.i18n.corso+": "+e.corso_des+", "+s.i18n.anno_di_offerta_sh+": "+e.aa+")</div>"}),n+="</ul>"},s.makePersonaLink=function(o,i,t,a,r){var c={docente:o,anno:t,grafica:s.grafica};return i?"AA"==e.ateneo.link_docente?i:"GG"==e.ateneo.link_docente?'<a href="'+n.href("docente",c)+'">'+i+"</a>":"TT"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":"PP"==e.ateneo.link_docente?e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":"TP"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":void 0:""};let d=e.$on("browser-back",function(){s.params=e.params,s.docenti=e.results,s.resolved=!0});s.submit=function(){var n=s.params;e.params=s.params,n.anno=e.year.value,c.cercaDocenti(n,function(n){s.docenti=n,s.localizeData(),_.each(s.docenti,function(n){n.insegnamenti&&n.insegnamenti.length>0&&(n.insegnamenti=_.uniqBy(n.insegnamenti,function(e){return e.cod+"|"+e.aa+"|"+e.corso_cod+"|"+e.schemaId+"|"+e.ordinamento_aa}),n.insegnamenti=_.filter(n.insegnamenti,function(e){return!e.modulo_di&&!e.frazione_di}),"1"==e.ateneo.visualizzazione_offerte_attive&&(n.insegnamenti=_.filter(n.insegnamenti,function(e){return"A"==e.statoAttivita})),n.insegnamentiHTML=s.makeInsegnamentiHtml(n.insegnamenti),n.linkHTML=s.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink))}),e.results=s.docenti,s.smallScreen&&i(function(){var e=angular.element(document.getElementById("risultati-ricerca"));o.scrollToElement(e,50,100)},100)})},s.reset=function(){s.params={},s.docenti=[]},s.aggiornaAnnoHeader=function(n){e.$emit("year-changed-secondary",{check:"cercaDocenti",value:n.aa.toString(),label:n.aa+"/"+(parseInt(n.aa)+1)})}}]}),catalogo.component("cercaInsegnamenti",{templateUrl:"html/components/cerca-insegnamenti.html",controller:["$rootScope","$document","$timeout","$location","META","LOCALIZE","RICERCA",function(e,n,o,i,t,a,r){var c=this;c.params={},c.$onInit=function(){c.i18n=e.ateneo.i18n,c.smallScreen=window.matchMedia("(max-width: 1023px)").matches,c.cercaInsegnamento=e.ateneo.ricerca&&e.ateneo.ricerca.cercaInsegnamento?e.ateneo.ricerca.cercaInsegnamento:null,c.mostraCampoSsd=!0,c.mostraCampoLingua=!0,c.mostraCampoDipartimento=!0,c.cercaInsegnamento&&(c.mostraCampoSsd=_.find(c.cercaInsegnamento,function(e){return"settoreScientificoDisciplinare"===e.nomeCampo}).visibile,c.mostraCampoLingua=_.find(c.cercaInsegnamento,function(e){return"linguaDiErogazione"===e.nomeCampo}).visibile,c.mostraCampoDipartimento=_.find(c.cercaInsegnamento,function(e){return"dipartimento"===e.nomeCampo}).visibile),c.dipartimenti=r.ricercaDipartimentiTendina({anno:e.year.value},function(e){c.dipartimenti=a.collection(e)}),c.lingue=r.ricercaLingueTendina({anno:e.year.value},function(e){c.lingue=a.collection(e)}),c.years=e.ateneo.aa,c.years_off=_.clone(c.years),c.params.anno_off=c.years_off[0].value;for(var n=parseInt(_.first(c.years).value),t=1;t<7;t++)c.years_off.unshift({label:n+t+"/"+(n+1+t),value:(n+t).toString()});c.afAttive=e.ateneo.visualizzazione_offerte_attive,o(function(){c.localizeData()},10),i.search().grafica&&(c.grafica=i.search().grafica)},c.setPageTitle=function(){e.$emit("pageTitle",{title:c.i18n.cercainsegnamento,nota:c.i18n.criterio_ricerca_insegnamento}),t.setTitle(c.i18n.cercainsegnamento)},c.localizeData=function(){c.setPageTitle(),a.collection(c.lingue),a.collection(c.dipartimenti),c.insegnamenti&&a.collection(c.insegnamenti)},c.$onDestroy=function(){s(),l()};let s=e.$on("lang-changed",function(){c.localizeData()}),l=e.$on("browser-back",function(){c.params=e.params,c.insegnamenti=e.results,c.resolved=!0});c.ssdQueryFunction=function(n){return new Promise(function(o,i){r.ricercaSsdTendina({anno:c.params.anno_off||e.year.value,searchString:n},function(e){c.ssd=e,o(c.ssd)},function(e){console.log("Errore autocomplete",e),i(e)})})},c.ssdCallbackFunction=function(e){c.params.ssdSearchString=e.cod},c.corsiQueryFunction=function(n){return delete c.params.cdsCod,new Promise(function(o,i){r.ricercaCorsiTendina({searchString:n,anno:c.params.anno_off||e.year.value,dipartimento:c.params.dipartimento||null},function(e){c.corsiTendina=e,a.collection(c.corsiTendina),_.each(c.corsiTendina,function(e){e.label="["+e.cdsCod+"] "+e.des}),o(c.corsiTendina)},function(e){console.log("Errore autocomplete",e),i(e)})})},c.corsiCallbackFunction=function(e){c.params.corsiSearchString=e.des_it,c.params.cdsCod=e.cod},c.changeDipartimento=function(){c.params.corsiSearchString=null,c.params.cdsCod=""},c.submit=function(){var i=c.params;e.params=c.params,"1"==e.ateneo.visualizzazione_offerte_attive&&(i.attive="A"),r.cercaInsegnamenti(i,function(i){i=_.filter(i,function(e){return!e.frazione_di});var t=_.uniqBy(i,function(e){return e.cod+"|"+e.aa+"|"+e.corso_cod+"|"+e.schemaId+"|"+e.af_percorso_id+"|"+e.ordinamento_aa});for(var r in c.resolved=!0,c.insegnamenti=a.collection(t),c.insegnamentiGruppi=[],c.insegnamenti=_.orderBy(c.insegnamenti,[function(e){return e.cod}]),c.gruppi=_.groupBy(c.insegnamenti,function(e){return[e.cod,e.cdsCod,e.af_percorso_id]}),c.gruppi){var s=c.gruppi[r],l={};l.insGruppo=s;var d="",u=_.find(s,function(e){return!e.modulo_di&&"9999"===e.af_percorso_id})?_.find(s,function(e){return!e.modulo_di&&"9999"===e.af_percorso_id}):_.find(s,function(e){return"9999"===e.af_percorso_id});u?(u.principale=!0,l.insPrincipale=u):_.map(s,function(e){e.principale=!0,l.insPrincipale=e}),l.insPrincipale.docenti.forEach(function(e,n){n===l.insPrincipale.docenti.length-1?d+=e.des:d+=e.des+", \n"}),l.insPrincipale.listaDocenti=d,c.insegnamentiGruppi.push(l)}for(var r in c.insegnamenti){var m=c.insegnamenti[r];m.corso_anno&&"0"!==m.corso_anno&&"altreAttivita"!==m.corso_anno?m.anno_di_corso="("+m.corso_anno+"° "+c.i18n.anno+" , coorte: "+m.corso_aa+")":m.corso_anno&&"0"===m.corso_anno.toString()&&(m.anno_di_corso="("+c.i18n.attivita_senza_anno+" , coorte: "+m.corso_aa+")")}e.results=c.insegnamenti,c.smallScreen&&o(function(){var e=angular.element(document.getElementById("risultati-ricerca"));n.scrollToElement(e,50,100)},100)})},c.reset=function(){c.params={},c.insegnamenti=[],c.resolved=!1},c.aggiornaAnnoHeader=function(n){e.$emit("year-changed-secondary",{check:"cercaInsegnamenti",value:n.corso_aa.toString(),label:n.corso_aa+"/"+(parseInt(n.corso_aa)+1)})}}]}),catalogo.component("cercaOfferta",{templateUrl:"html/components/cerca-offerta.html",controller:["$rootScope","$document","$timeout","$location","META","LOCALIZE","RICERCA","CREA_PDF",function(e,n,o,i,t,a,r,c){var s=this;s.params={},s.$onInit=function(){s.i18n=e.ateneo.i18n,s.smallScreen=window.matchMedia("(max-width: 1023px)").matches,s.cercaOfferta=e.ateneo.ricerca&&e.ateneo.ricerca.cercaOfferta?e.ateneo.ricerca.cercaOfferta:null,s.mostraCampoSsd=!0,s.mostraCampoLingua=!0,s.mostraCampoDipartimento=!0,s.cercaOfferta&&(s.mostraCampoSsd=_.find(s.cercaOfferta,function(e){return"settoreScientificoDisciplinare"===e.nomeCampo}).visibile,s.mostraCampoLingua=_.find(s.cercaOfferta,function(e){return"linguaDiErogazione"===e.nomeCampo}).visibile,s.mostraCampoDipartimento=_.find(s.cercaOfferta,function(e){return"dipartimento"===e.nomeCampo}).visibile),s.dipartimenti=r.ricercaDipartimentiTendina({anno:e.year.value},function(e){s.dipartimenti=a.collection(e)}),s.lingue=r.ricercaLingueTendina({anno:e.year.value},function(e){s.lingue=a.collection(e)}),s.years=e.ateneo.aa,s.years_off=_.clone(s.years),s.params.anno_off=s.years_off[0].value,s.afAttive=e.ateneo.visualizzazione_offerte_attive,o(function(){s.localizeData()},10),i.search().grafica&&(s.grafica=i.search().grafica)},s.setPageTitle=function(){e.$emit("pageTitle",{title:s.i18n.cercaofferta}),t.setTitle(s.i18n.cercaofferta)},s.localizeData=function(){s.setPageTitle(),a.collection(s.lingue),a.collection(s.dipartimenti),s.insegnamenti&&a.collection(s.insegnamenti)},s.$onDestroy=function(){l(),d()};let l=e.$on("lang-changed",function(){s.localizeData()}),d=e.$on("browser-back",function(){s.params=e.params,s.insegnamenti=e.results,s.resolved=!0});s.ssdQueryFunction=function(n){return new Promise(function(o,i){r.ricercaSsdTendina({anno:s.params.anno_off||e.year.value,searchString:n},function(e){s.ssd=e,o(s.ssd)},function(e){console.log("Errore autocomplete",e),i(e)})})},s.ssdCallbackFunction=function(e){s.params.ssdSearchString=e.cod},s.corsiQueryFunction=function(n){return delete s.params.cdsCod,new Promise(function(o,i){r.ricercaCorsiTendina({searchString:n,anno:s.params.anno_off||e.year.value,dipartimento:s.params.dipartimento||null},function(e){s.corsiTendina=e,a.collection(s.corsiTendina),_.each(s.corsiTendina,function(e){e.label="["+e.cdsCod+"] "+e.des}),o(s.corsiTendina)},function(e){console.log("Errore autocomplete",e),i(e)})})},s.corsiCallbackFunction=function(e){s.params.corsiSearchString=e.des_it,s.params.cdsCod=e.cod},s.changeDipartimento=function(){s.params.corsiSearchString=null,s.params.cdsCod=""},s.submit=function(){var i=s.params;e.params=s.params,"1"==e.ateneo.visualizzazione_offerte_attive&&(i.attive="A"),r.cercaOfferta(i,function(i){i=_.filter(i,function(e){return!e.frazione_di&&!e.modulo_di});var t=_.uniqBy(i,function(e){return e.cod+"|"+e.aa+"|"+e.corso_cod+"|"+e.schemaId+"|"+e.af_percorso_id+"|"+e.ordinamento_aa});for(var r in s.resolved=!0,s.insegnamenti=a.collection(t),s.insegnamentiGruppi=[],s.insegnamenti=_.orderBy(s.insegnamenti,[function(e){return e.cod}]),s.gruppi=_.groupBy(s.insegnamenti,function(e){return[e.cod,e.cdsCod,e.af_percorso_id]}),s.gruppi){var c=s.gruppi[r],l={};l.insGruppo=c;var d="",u=_.find(c,function(e){return"9999"===e.af_percorso_id});u?(u.principale=!0,l.insPrincipale=u):_.map(c,function(e){e.principale=!0,l.insPrincipale=e}),l.insPrincipale.docenti.forEach(function(e,n){n===l.insPrincipale.docenti.length-1?d+=e.des:d+=e.des+", \n"}),l.insPrincipale.listaDocenti=d,s.insegnamentiGruppi.push(l)}for(var r in s.insegnamentiGruppi=s.insegnamentiGruppi.sort(function(e,n){return e.insPrincipale.des<n.insPrincipale.des?-1:e.insPrincipale.des>n.insPrincipale.des?1:0}),s.insegnamenti){var m=s.insegnamenti[r];m.corso_anno&&"0"!==m.corso_anno&&"altreAttivita"!==m.corso_anno?m.anno_di_corso="("+m.corso_anno+"° "+s.i18n.anno+" , coorte: "+m.corso_aa+")":m.corso_anno&&"0"===m.corso_anno.toString()&&(m.anno_di_corso="("+s.i18n.attivita_senza_anno+" , coorte: "+m.corso_aa+")")}e.results=s.insegnamenti,s.smallScreen&&o(function(){var e=angular.element(document.getElementById("risultati-ricerca"));n.scrollToElement(e,50,100)},100)})},s.reset=function(){s.params={},s.insegnamenti=[],s.resolved=!1},s.aggiornaAnnoHeader=function(n){e.$emit("year-changed-secondary",{check:"cercaOfferta",value:n.corso_aa.toString(),label:n.corso_aa+"/"+(parseInt(n.corso_aa)+1)})},s.pdf=function(){var n={ateneo:e.ateneo.des,logoimg:"/img/"+e.ateneo.ate_cod+"/logoreport.png",atecod:e.ateneo.ate_cod,titolo:s.i18n.risultati_ricerca,accordion:[]};for(let e of s.insegnamenti){let o="";e.corso_percorso_des?o+=s.i18n.corso+": "+e.corso_des+", "+s.i18n.anno_di_offerta_sh+": "+e.aa+", "+s.i18n.percorso+": "+e.corso_percorso_des+" "+e.anno_di_corso:o+=s.i18n.corso+": "+e.corso_des+", "+s.i18n.anno_di_offerta_sh+": "+e.aa,e.crediti&&(o+=", "+e.crediti+" "+s.i18n.cfu_insegnamento);let i={type:"text",title:"["+e.adCod+"] "+e.des,subtitle:o};n.accordion.push(i)}c.create("report_listaOfferta.pdf","client/html/template/templateListaPdf.html",n)}}]}),catalogo.component("closure",{templateUrl:"html/components/closure.html",controller:["$rootScope",function(e){var n=this;n.$onInit=function(){n.i18n=e.ateneo.i18n},n.$onDestroy=function(){o()};let o=e.$on("lang-changed",function(){n.ateneo=e.ateneo,n.homepage=e.ateneo.url,n.i18n=e.ateneo.i18n,n.testoUltimoAggiornamento="en"==e.lang?"Last update:":"Ultimo aggiornamento:",n.testoAggiornamentoInCorso="en"==e.lang?"Update in progress":"Aggiornamento in corso",n.formatoData="en"==e.lang?"MM/dd/yyyy HH:mm":"dd/MM/yyyy HH:mm",n.ultimoAggiornamento=n.ateneo.aggiornamento_be&&n.ateneo.aggiornamento_be.data_fine?new Date(n.ateneo.aggiornamento_be.data_fine):""})}]}),catalogo.component("cookieLaw",{templateUrl:"html/components/cookie-law.html",controller:["$rootScope","LOCALIZE",function(e,n){var o=this;o.lang=n.lang(),o.pdfExists=function(n){return"lumsa"===e.ateneo.ate_cod&&n},o.pdfCookie_it=o.pdfExists("/img/"+e.ateneo.ate_cod+"/privacyCookie_it.pdf#toolbar=0&navpanes=0&scrollbar=0"),o.pdfCookie_en=o.pdfExists("/img/"+e.ateneo.ate_cod+"/privacyCookie_en.pdf#toolbar=0&navpanes=0&scrollbar=0"),o.setPageTitle=function(){e.$emit("pageTitle",{title:"Cookie policy"})},o.localizeData=function(){o.setPageTitle()},o.$onDestroy=function(){i()};let i=e.$on("lang-changed",function(){o.lang=n.lang(),o.localizeData()});o.setPageTitle()}]}),catalogo.component("corsi",{templateUrl:"html/components/corsi.html",controller:["$rootScope","$state","$timeout","$location","META","STATEPARAMS","LOCALIZE","CORSI",function(e,n,o,i,t,a,r,c){var s=this;s.getData=function(){s.params=a.get(),s.params.minimal=!0,s.no_groups=[],s.groups=c.query(s.params,function(n){s.localizeData();for(let e of n)for(let n of e.subgroups)for(let e of n.cds)s.no_groups.push(e);e.$emit("search-complete")}),i.search().grafica&&(s.grafica=i.search().grafica)},s.$onInit=function(){s.i18n=e.ateneo.i18n,s.tipoHome=e.ateneo.tipo_home,s.getData(),s.localizeData(),s.params.filter&&o(function(){e.$emit("open-filters")},200),s.data=(new Date).getFullYear()},s.localizeData=function(){t.setTitle(s.i18n.corsi),s.groups.forEach(function(e){r.object(e),e.subgroups.length&&e.subgroups.forEach(function(e){r.object(e),e.cds.length&&e.cds.forEach(function(e){r.object(e)})})})},s.$onDestroy=function(){l(),d()};let l=e.$on("lang-changed",function(){s.localizeData()}),d=e.$on("year-changed",function(e,i){s.params.anno=i.value?i.value:i,o(function(){n.go(n.current,s.params,{reload:!0})})})}]}),catalogo.component("corsoInsegnamenti",{templateUrl:"html/components/corso-insegnamenti.html",require:{parent:"^corso"},controller:["$rootScope","$state","$document","$timeout","$location","META","CALENDARIO_UP",function(e,n,o,i,t,a,r){var c=this;c.annoPassato=function(e,n){var o=new Date,i=o.getMonth()>=5?o.getFullYear():o.getFullYear()-1;return n?e<=i:e<i},c.getCalendarioPubblicoUP=function(n){let o=new Date(c.parent.corso.aa.substr(0,4)+"-"+e.ateneo.up.daData.substr(5,2)+"-"+e.ateneo.up.daData.substr(8,2));o=moment(o).format("DD/MM/YYYY");let i=s();if(i){let e=_.find(i.anni,function(e){if(e.anno==n)return e});e&&(c.annoAccademico=e.annoOfferta+"")}c.configUP={annoRegolamento:parseInt(c.parent.corso.aa),annoAccademico:c.annoAccademico+"",annoCorso:parseInt(n),codiceCorso:c.parent.corso.cdsCod,annoOrdinamento:parseInt(c.parent.corso.ordinamento_aa),dataInizio:o,lang:e.ateneo.up.lang,tipologieGuol:e.ateneo.up.tipologieGuol,vistaDefault:e.ateneo.up.vistaDefault,coloraPer:e.ateneo.up.coloraPer,mostraImpegniAnnullati:e.ateneo.up.mostraImpegniAnnullati,mostraPrimoDettaglio:e.ateneo.up.mostraPrimoDettaglio,switchRealeTemplate:e.ateneo.up.switchRealeTemplate,template:e.ateneo.up.template,tipoLink:"guide_online"},"true"===e.ateneo.up.filtraPerPercorso&&(c.configUP.codicePercorso=i.pdsCod);let t={payload:c.configUP,url:e.ateneo.up.url};r.calendarioPubblicoUP(t,function(e){console.log("Calendario pubblico UP creato: "+e.urlUP),window.open(e.urlUP,"_blank")},function(e){console.log(e)})},c.$onInit=function(){c.ateneo=e.ateneo,c.i18n=e.ateneo.i18n,c.cardInsegnamento=e.ateneo.card_insegnamento,c.visualizzazione_insegnamenti=e.ateneo.visualizzazione_insegnamenti,c.modal={open:!1,title:c.parent.i18n.scegli_percorso,dismissable:!1,back:!0},c.year=e.year&&e.year.value?e.year.value:c.parent.params.anno,c.parent.corso.percorsi.length>1&&!n.params.percorso?c.modal.open=!0:c.modal.open=!1,c.state=n,c.afAttive=e.ateneo.visualizzazione_offerte_attive;var o=e.ateneo?e.ateneo.aa:[],a=Math.max.apply(Math,o.map(function(e){return e.value}));c.mostraPulsanteUP=function(n){return!!(e.ateneo.up.url&&""!==e.ateneo.up.url&&e.ateneo.up.visibileListaInsegnamenti&&parseInt(n.annoOfferta)<=a)},c.makeAccordion(),n.params["#"]&&i(function(){c.scrollToYear(n.params["#"])},200),t.search().grafica&&(c.grafica=t.search().grafica)};var s=function(){return _.find(c.parent.corso.percorsi,function(e){return n.params.schemaid?(e.pdsId==n.params.percorso||e.pdsCod==n.params.percorso)&&e.schemaId==n.params.schemaid:e.pdsId==n.params.percorso||e.pdsCod==n.params.percorso})};c.$onChanges=function(){if(c.i18n=e.ateneo.i18n,c.cardInsegnamento=e.ateneo.card_insegnamento,c.visualizzazione_insegnamenti=e.ateneo.visualizzazione_insegnamenti,n.params.percorso){var o=s();o&&(a.setTitle(c.parent.corso.des+", "+o.des),e.$emit("percorso",o),o.anni&&o.anni.length>0&&("2"===c.visualizzazione_insegnamenti&&(c.soloOfferta=!0),c.noOfferta=0===o.anni.length,o.anni.forEach(function(n){n.insegnamenti&&n.insegnamenti.length>0&&n.insegnamenti.forEach(function(n){n.accordion=[],(n.nota1||n.nota2||n.filtri||n.condizioni)&&(n.nota1&&n.accordion.push({title:c.i18n.nota1,type:"text",body:n.nota1,open:!0}),n.nota2&&n.accordion.push({title:c.i18n.nota2,type:"text",body:n.nota2,open:!0}),!n.filtri||"S"===n.tipSce&&"0"===e.ateneo.visualizzazione_filtri_regsce_S||n.accordion.push({title:c.i18n.filtri,type:"text",body:n.filtri,open:!0}),n.condizioni&&n.accordion.push({title:c.i18n.condizioni,type:"text",body:n.condizioni,open:!0}))})})))}},c.scrollToYear=function(e){c.anno=e;var n=angular.element(document.getElementById(e));o.scrollToElement(n,50,100)},c.filterFn=function(e){return!!(e.attivita.length>0||e.filtri&&e.filtri.length>0||e.nota1||e.nota2)},c.open="1"===e.ateneo.visualizzazione_regsce,c.makeAccordion=function(){try{c.accordionPianiDiStudio=[{title:c.i18n.informazioni_piani_di_studio,type:"list",body:[],open:!0}],c.parent.corso&&c.parent.corso.percorso&&(c.parent.corso.percorso.partTimeDes&&""!==c.parent.corso.percorso.partTimeDes&&c.accordionPianiDiStudio[0].body.push({label:"Part-time",value:c.parent.corso.percorso.partTimeDes}),c.parent.corso.percorso.orientamentoDes&&""!==c.parent.corso.percorso.orientamentoDes&&c.accordionPianiDiStudio[0].body.push({label:c.i18n.orientamento,value:c.parent.corso.percorso.orientamentoDes}),c.parent.corso.percorso.profiloCod&&""!==c.parent.corso.percorso.profiloCod&&c.accordionPianiDiStudio[0].body.push({label:c.i18n.profilo_studente,value:c.parent.corso.percorso.profiloCod}))}catch(e){console.log("Errore durante la creazione dell'accordion del corso",e)}}}]}),catalogo.component("corso",{templateUrl:"html/components/corso.html",controller:["$rootScope","$state","$timeout","$location","META","STATEPARAMS","LOCALIZE","CORSO",function(e,n,o,i,t,a,r,c){var s=this;s.visualizzazioneInfoCorso=e.ateneo.visualizzazione_info_corso,s.dettaglioCorso=e.ateneo.dettaglio_corso;var l=_.filter(s.dettaglioCorso,function(e){return"informazioniGenerali"===e.nomeCampo.substring(0,e.nomeCampo.indexOf("."))}),d=_.filter(s.dettaglioCorso,function(e){return"requisitiAccesso"===e.nomeCampo.substring(0,e.nomeCampo.indexOf("."))});s.$onInit=function(){s.i18n=e.ateneo.i18n,s.params=a.get(),s.state=n,s.year=s.params.anno||e.year.value,s.corso=c.get({anno:s.params.anno,corso:s.params.corso,annoOrdinamento:s.params.annoOrdinamento},function(e){s.localizeData()},function(n){lang=r.lang(),s.noPageTitle={nessunDato:!0},e.$emit("pageTitle",s.noPageTitle)}),i.search().grafica&&(s.grafica=i.search().grafica)},s.$onDestroy=function(){m(),u(),p()};let u=e.$on("lang-changed",function(){s.localizeData(),s.ripopolaNote()}),m=e.$on("year-changed",function(e,i){s.params.anno=i.value?i.value:i,o(function(){n.go(n.current,s.params,{reload:!0})})});s.setPageTitle=function(){var o={title:(s.corso.cdsCod?"["+s.corso.cdsCod+"] ":"")+s.corso.des};s.corso.percorso&&s.corso.percorsi.length>1&&(o.subtitle=s.corso.percorso.des,o.link={url:s.makeCorsoUrl(n.params.anno,n.params.corso,n.params.annoOrdinamento),text:s.i18n.cambia}),o.nota=s.i18n.nota_cds_cc,e.$emit("pageTitle",o)},s.makeTabs=function(){s.tabs=[],s.visualizzazioneInfoCorso&&s.visualizzazioneInfoCorso.visibile&&(_.some(l,function(e){return e.visibile})||_.some(d,function(e){return e.visibile}))?s.tabs.push({text:"Info",href:n.href("corso"),active:n.is("corso")}):s.corso.percorsi&&s.corso.percorsi.length>0&&n.go("corso.insegnamenti",s.insegnamentiPath()),s.corso.percorsi&&s.corso.percorsi.length>0&&s.tabs.push({text:s.i18n.piani_di_studio,href:n.href("corso.insegnamenti",s.insegnamentiPath()),active:n.is("corso.insegnamenti")})},s.noInsegnamenti=function(){s.corso.noInsegnamenti=[{title:s.i18n.no_recupero_insegnamenti,type:"text",body:s.i18n.no_recupero_insegnamenti_desc.replace("{{home-url}}",n.href("home")),warning:!0,open:!0}]};let p=e.$on("percorso",function(e,n){s.corso.percorso=n,s.corso.anni=_.map(n.anni,function(e){var n=e.annoOfferta;return isNaN(parseInt(n))||(n=n+"/"+(parseInt(n)+1)),{anno:e.anno,annoOfferta:n}}),s.setPageTitle(),s.makeTabs()});s.makeCorsoUrl=function(e,o,i){var t={anno:e,corso:o,percorso:null,annoOrdinamento:i,grafica:s.grafica};return n.href("corso.insegnamenti",t)},s.localizeData=function(){let n=document.getElementById("scrollUpBtn");n.style.display="none",window.onscroll=function(){document.body.scrollTop>20||document.documentElement.scrollTop>20?n.style.display="block":n.style.display="none"},s.topFunction=function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},s.corso&&s.corso.$resolved&&(r.object(s.corso),t.setTitle(s.corso.des||s.i18n.attenzione),s.corso.tasse&&r.collection(s.corso.tasse),s.corso.scadenze&&r.collection(s.corso.scadenze),s.corso.percorsi&&(r.collection(s.corso.percorsi),s.corso.percorsi.forEach(function(e){e.anni&&(r.collection(e.anni),e.anni.forEach(function(e){e.insegnamenti&&(r.collection(e.insegnamenti),e.insegnamenti.forEach(function(e){r.object(e.label),r.collection(e.attivita),e.nota1&&r.object(e.nota1),e.nota2&&r.object(e.nota2)})),e.attivita&&r.collection(e.attivita)}))})),s.noPageTitle?e.$emit("pageTitle",s.noPageTitle):(s.makeAccordion(),s.makeTabs(),s.setPageTitle(),s.noInsegnamenti()))},s.insegnamentiPath=function(){return s.corso.percorsi&&1===s.corso.percorsi.length?{percorso:s.corso.percorsi[0].pdsId,grafica:s.grafica}:s.corso.percorsi&&s.corso.percorsi.length>1?s.corso.percorso?{percorso:s.corso.percorso.pdsId,grafica:s.grafica}:{percorso:null,grafica:s.grafica}:void 0},s.makeAccordion=function(){try{data=new Date,s.accordion=[];var o=!1;if(_.some(l,function(e){return e.visibile})){if(o=!0,s.accordion.push({title:s.i18n.info_generali_corso,type:"list",body:[],open:!0}),s.corso.durata&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.durata"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.durata,value:s.corso.durata}),s.corso.ordinamento_aa&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.ordinamento"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.ordinamento,value:s.corso.ordinamento_aa.toString()}),s.corso.ordinamento_stato_des&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.stato"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.stato,value:s.corso.ordinamento_stato_des}),"null"!==s.corso.crediti&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.crediti"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.crediti_corso,value:s.corso.crediti+" "+s.i18n.cfu_corso}),s.corso.lingua_des&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.linguaCorso"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.linguaCorso,value:s.corso.lingua_des}),s.corso.gruppo_des&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.tipologia"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.gruppo,value:'<a href="'+n.href("corsi",{anno:s.corso.aa,gruppo:s.corso.gruppo_cod,grafica:s.grafica})+'">'+s.corso.gruppo_des+"</a>"}),s.corso.normativa&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.normativa"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.normativa,value:s.corso.normativa}),s.corso.classe&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.classeLaurea"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.classe,value:s.corso.classe_cod?s.corso.classe_cod+" - "+s.corso.classe:""+s.corso.classe}),s.corso.ordinamento_stato&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.accesso"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.accesso,value:"C"==s.corso.ordinamento_stato&&s.corso.ordinamento_aa_cess<data.getFullYear()?s.i18n.no_immatricolazione:s.corso.accesso}),s.corso.sede_des&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.sede"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.sede,value:s.corso.sede_des}),s.corso.altreSedi&&s.corso.altreSedi.length>0&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.altreSedi"===e.nomeCampo}).visibile){let e=[];for(let n of s.corso.altreSedi)e.push(n.sede_des_it);s.accordion[0].body.push({label:s.i18n.altreSedi,value:e.join(", ")})}if(s.corso.dip_des&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.dipartimento"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.dipartimento,value:s.corso.dip_des}),s.corso.linkRegolamentoDidattico&&""!==s.corso.linkRegolamentoDidattico&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.linkRegolamento"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.link_regolamento_didattico,value:'<a target="_blank" href="'+s.corso.linkRegolamentoDidattico+'">'+s.i18n.scarica_documento+"</a>"}),s.corso.sitoweb&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.sitoWeb"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.sitoweb,value:'<a target="_blank" href="'+s.corso.sitoweb+'">'+s.corso.sitoweb+"</a>"}),s.corso.urlInfoWeb&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.sitoInformativo"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.sitoInformativo,value:'<a target="_blank" href="'+s.corso.urlInfoWeb+'">'+s.corso.urlInfoWeb+"</a>"}),s.corso.interClasse_cod&&s.accordion[0].body.splice(6,0,{label:s.i18n.inter_classe,value:s.corso.interClasse_cod?s.corso.interClasse_cod+" - "+s.corso.interClasse:""+s.corso.interClasse}),s.corso.modalita_didattica&&""!==s.corso.modalita_didattica&&_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.modalitaDidattica"===e.nomeCampo}).visibile&&s.accordion[0].body.push({label:s.i18n.modalita_didattica,value:s.corso.modalita_didattica}),_.find(s.dettaglioCorso,function(e){return"informazioniGenerali.docentiCorso"===e.nomeCampo}).visibile){var i={anno:s.corso.aa,ordinamento_aa:s.corso.ordinamento_aa,corso_cod:s.corso.cod,grafica:s.grafica};s.accordion[0].body.push({label:s.i18n.docenti_corso,value:'<a target="_blank" href="'+n.href("lista-docenti",i)+'">'+s.i18n.vedi_lista_docenti+"</a>"})}0==s.accordion[0].body.length&&(s.accordion.pop(),o=!1)}if(s.corso.requisiti&&_.some(d,function(e){return e.visibile})){var t=o?1:0,a=s.corso.requisiti;if(s.accordion.push({title:s.i18n.requisiti_accesso,type:"list",body:[],open:!1}),a.obbligatori&&a.obbligatori.length>0&&_.find(s.dettaglioCorso,function(e){return"requisitiAccesso.titoliObbligatori"===e.nomeCampo}).visibile){var r="";for(let e of a.obbligatori)r+="["+e.tipoTitCod+"] "+e.tipoTitDes+"</br>";s.accordion[t].body.push({label:s.i18n.titoli,value:r})}if(a.optional&&a.optional.length>0&&_.find(s.dettaglioCorso,function(e){return"requisitiAccesso.titoliOpzionali"===e.nomeCampo}).visibile){var c="";for(let e of a.optional){c+="["+e.combTaDes+"] ";let n=[];for(let o of e.tipi)n.push(o.tipoTitDes);c+=n.join(", ")+"</br>"}s.accordion[t].body.push({label:s.i18n.opzione_scelta,value:c})}0==s.accordion[t].body.length&&s.accordion.pop()}if(s.corso.tasse_contributi&&s.corso.tasse_contributi.length>0&&_.find(s.dettaglioCorso,function(e){return"tasseContributi"===e.nomeCampo}).visibile){var u="",m=[];if(e.ateneo.descr_tasse||(e.ateneo.descr_tasse="strutt"),"strutt"===e.ateneo.descr_tasse){for(let e of s.corso.tasse_contributi){var p=s.i18n.tasse_contributi_importo+" € "+e.importo;e.scadenzaDta&&(p+=" entro il "+e.scadenzaDta),m.push({label:e.causale,value:p+"<br />"})}s.accordion.push({title:s.i18n.tasse_contributi,type:"list",body:m,open:!1})}else{for(let e of s.corso.tasse_contributi){u+=e.causale+"<br />";break}s.accordion.push({title:s.i18n.tasse_contributi,type:"text",body:u,open:!1})}}if(s.corso.date_scadenze&&s.corso.date_scadenze.length>0&&_.find(s.dettaglioCorso,function(e){return"dateScadenze"===e.nomeCampo}).visibile){u="";var g=[];if(e.ateneo.descr_scadenze||(e.ateneo.descr_scadenze="strutt"),"strutt"===e.ateneo.descr_scadenze){for(let e of s.corso.date_scadenze)if(!e.scadenza&&e.scadenzaDes){var f=e.scadenzaDtaInizio.split(" ")[0],b=e.scadenzaDtaFine.split(" ")[0];g.push({label:e.scadenzaDes,value:f+" - "+b+"<br />"})}g.length>0&&s.accordion.push({title:s.i18n.date_scadenze,type:"list",body:g,open:!1})}else{for(let e of s.corso.date_scadenze){e.scadenza&&!e.scadenzaDes&&(u+=e.scadenza+"<br />");break}u&&s.accordion.push({title:s.i18n.date_scadenze,type:"text",body:u,open:!1})}}s.corso.ruoli&&s.corso.ruoli.length&&_.find(s.dettaglioCorso,function(e){return"ruoli"===e.nomeCampo}).visibile&&s.accordion.push({title:s.i18n.ruoli,type:"list",body:_.map(s.corso.ruoli,function(e){return{label:e.carica,value:e.caricaNome+" "+e.caricaCognome}}),open:!1}),s.corso.programma_testi_obiettivi&&s.corso.programma_testi_obiettivi.length&&_.find(s.dettaglioCorso,function(e){return"programmaTesti"===e.nomeCampo}).visibile&&(s.corso.programma_testi_obiettivi=_.orderBy(s.corso.programma_testi_obiettivi,["ordine"],["asc"]),s.accordion.push({title:s.i18n.programma_testi_obiettivi,type:"list",body:_.map(s.corso.programma_testi_obiettivi,function(e){return{label:e.carattTitolo,value:e.carattTesto}}),open:!1}))}catch(e){console.log("Errore durante la creazione dell'accordion del corso",e)}},s.ripopolaNote=function(){s.corso&&s.corso.percorsi&&s.corso.percorsi.length>0&&s.corso.percorsi.forEach(function(e){e.anni&&e.anni.length>0&&e.anni.forEach(function(e){e.insegnamenti&&e.insegnamenti.forEach(function(e){(e.nota1||e.nota2)&&(e.accordion=_.filter(e.accordion,function(e){return e.title!==s.i18n.nota1||e.title!==s.i18n.nota2}),e.nota1&&e.accordion.push({title:s.i18n.nota1,type:"text",body:e.nota1,open:!1}),e.nota2&&e.accordion.push({title:s.i18n.nota2,type:"text",body:e.nota2,open:!1}))})})})}}]}),catalogo.component("docente",{templateUrl:"html/components/docente.html",controller:["$rootScope","$state","$timeout","$location","META","STATEPARAMS","LOCALIZE","DOCENTE","CONFIGURAZIONE",function(e,n,o,i,t,a,r,c,s){let l=this;l.$onInit=function(){l.i18n=e.ateneo.i18n,l.up=e.ateneo.up,l.params=a.get(),l.docente=c.get({docente:l.params.docente,anno:l.params.anno},function(){l.localizeData()},function(n){lang=r.lang(),l.noPageTitle={nessunDato:!0,paginaDocente:!0},e.$emit("pageTitle",l.noPageTitle)}),l.mostraPulsanteUP=function(){return!(!l.up.url||""===l.up.url||"true"!==l.up.visualizzaAgendaDocente||!l.docente.matricola)},i.search().grafica&&(l.grafica=i.search().grafica)},l.setPageTitle=function(){e.$emit("pageTitle",{title:l.docente.des,nota:l.i18n.nota_pagina_docente})},l.localizeData=function(){l.docente&&l.docente.$resolved&&(r.object(l.docente),r.collection(l.docente.insegnamenti),l.docente.insegnamenti.forEach(function(e){e.modulo_di&&r.object(e.modulo_di),e.frazione_di&&r.object(e.frazione_di)}),t.setTitle(l.docente.des||l.i18n.attenzione),l.noPageTitle?e.$emit("pageTitle",l.noPageTitle):(l.setPageTitle(),l.makeAccordion()))},l.apriAgendaDocente=function(){s.getConfig(function(n){if(n&&n.UP_URL&&""!==n.UP_URL){let o=e.ateneo.ate_cod&&"uninsubria"==e.ateneo.ate_cod?"unins":e.ateneo.ate_cod;l.url="https://"+o+"."+n.UP_URL+"/calendarioPubblico/matricola="+l.docente.matricola,window.open(l.url,"_blank")}})},l.makeInsegnamentiHtml=function(){let n="<ul>",o=_.filter(l.docente.insegnamenti,function(e){return!e.frazione_di}),i=_.groupBy(o,function(e){return e.adCod}),t=[];_.forEach(i,function(e){let n=_.filter(e,function(e){return!e.modulo_di&&!e.frazione_di});_.forEach(n,function(n){if(n.moduli&&n.moduli.length>0){let o=_.map(n.moduli,function(e){return e.cod}),i=_.filter(e,function(e){return _.includes(o,e.cod)&&e.corso_cod===n.corso_cod&&e.adCod===n.adCod});t=_.uniqWith(_.concat(t,i),_.isEqual)}else t.push(n)})}),"1"==e.ateneo.visualizzazione_offerte_attive&&(t=_.filter(_.clone(t),function(e){return"A"==e.statoAttivita})),t=_.uniqBy(t,function(e){return e.adCod+"|"+e.udCod+"|"+e.aa+"|"+e.corso_cod+"|"+e.schemaId+"|"+e.ordinamento_aa});let a=_.groupBy(t,function(e){return[e.cod,e.corso_cod]});return _.forEach(a,function(e){let o=e[0];o.modulo_di&&null!==o.modulo_di?n+="<li>["+o.udCod+"] "+o.des+" - <i>"+l.i18n.modulo_di+" ["+o.modulo_di.adCod+"] "+o.modulo_di.des+"</i></li>":n+="<li>["+o.adCod+"] "+o.des+"</li>",e.forEach(function(e){e.corso_percorso_des?n+='<div><a href="'+l.makeInsegnamentoUrl(e.aa,e.cod,e.ordinamento_aa,e.af_percorso_id,e.corso_cod,e.corso_aa,e.schemaId)+'">'+l.i18n.corso+": "+e.corso_des+" "+l.i18n.percorso+": "+e.corso_percorso_des+" (coorte: "+e.corso_aa+")</a></div>":n+='<div><a href="'+l.makeInsegnamentoUrl(e.aa,e.cod,e.ordinamento_aa,e.af_percorso_id,e.corso_cod,e.corso_aa,e.schemaId)+'">'+l.i18n.corso+": "+e.corso_des+"</a></div>"})}),n+="</ul>"},l.makeInsegnamentoUrl=function(e,o,i,t,a,r,c){let s={anno:e,insegnamento:o,ordinamento_aa:i,af_percorso:t,corso_cod:a,coorte:r,schemaid:c,grafica:l.grafica};return n.href("insegnamento",s)},l.makeOrarioHtml=function(){l.w={weekday_it:new Array(7),weekday_en:new Array(7)},l.w.weekday_it[1]="Lunedi",l.w.weekday_it[2]="Martedi",l.w.weekday_it[3]="Mercoledi",l.w.weekday_it[4]="Giovedi",l.w.weekday_it[5]="Venerdi",l.w.weekday_it[6]="Sabato",l.w.weekday_it[7]="Domenica",l.w.weekday_en[1]="Monday",l.w.weekday_en[2]="Tuesday",l.w.weekday_en[3]="Mercoled",l.w.weekday_en[4]="Gioved",l.w.weekday_en[5]="Friday",l.w.weekday_en[6]="Saturday",l.w.weekday_en[7]="Sunday",console.log("prima ",l.w),r.object(l.w),console.log("dopo ",l.w),weekday=l.w.weekday;let e=[];for(let n of l.docente.orari)e.push({label:"Giorno e Ora",value:weekday[n.giorno]+" dalle "+n.oraInizio.replace("01/01/1900 ","").substr(0,5)+" alle "+n.oraFine.replace("01/01/1900 ","").substr(0,5)}),e.push({label:"Luogo",value:n.desLuogo}),e.push({label:"Note",value:n.nota});return e},l.makeAccordion=function(){try{l.accordion=[{title:l.i18n.info_generali,type:"list",body:[],open:!0}],l.docente.matricola&&e.ateneo.mostra_matricola_docente&&1==e.ateneo.mostra_matricola_docente&&l.accordion[0].body.push({label:l.i18n.matricola,value:l.docente.matricola}),l.docente.email&&l.accordion[0].body.push({label:"Email",value:'<a target="_blank" href="mailto:'+l.docente.email+'">'+l.docente.email+"</a>"}),"GG"==e.ateneo.link_docente&&l.docente.hyperlink&&l.accordion[0].body.push({label:l.i18n.pagina_docente,value:'<a target="_blank" href="'+l.docente.hyperlink+'">'+l.docente.hyperlink+"</a>"}),l.docente.facDes&&l.accordion[0].body.push({label:l.i18n.unita_organizzativa,value:l.docente.facCod+" - "+l.docente.facDes}),e.ateneo.utilizza_unifind&&l.docente.urlUnifind&&""!==l.docente.urlUnifind&&l.accordion[0].body.push({label:l.i18n.linkUnifind,value:'<a target="_blank" href="'+l.docente.urlUnifind+'">'+l.i18n.stringaLinkUnifind+"</a>"}),l.docente.orari&&l.docente.orari.length>0&&l.accordion.push({title:l.i18n.orario_docenze,type:"list",body:l.makeOrarioHtml()}),l.docente.insegnamenti&&l.docente.insegnamenti.length&&l.accordion.push({title:l.i18n.insegnamenti,type:"text",body:l.makeInsegnamentiHtml(),open:!0}),l.docente.biografia&&l.accordion.push({title:l.i18n.biografia,type:"text",body:l.docente.biografia.replace(/\n/g,"<br />")}),l.docente.curriculum&&l.accordion.push({title:"Curriculum",type:"text",body:l.docente.curriculum.replace(/\n/g,"<br />")}),l.docente.pubblicazioni&&l.accordion.push({title:l.i18n.pubblicazioni,type:"text",body:l.docente.pubblicazioni.replace(/\n/g,"<br />")}),l.docente.note&&l.accordion.push({title:l.i18n.note,type:"text",body:l.docente.note.replace(/\n/g,"<br />")})}catch(e){console.log("Errore durante la creazione dell'accordion del docente",e)}},l.$onDestroy=function(){d(),u()};let d=e.$on("lang-changed",function(){l.localizeData()}),u=e.$on("year-changed",function(e,i){l.params.anno=i&&i.value?i.value:i,o(function(){n.go(n.current,l.params,{reload:!0})})})}]}),catalogo.component("filterPanel",{templateUrl:"html/components/filter-panel.html",controller:["$rootScope","$state","$timeout","STATEPARAMS","LOCALIZE","RICERCA",function(e,n,o,i,t,a){var r=this;r.$onInit=function(){r.tipoHome=e.ateneo.tipo_home,r.anno=e.year&&e.year.value?e.year.value:e.year,r.filtroListaCorsi=e.ateneo.ricerca&&e.ateneo.ricerca.filtroListaCorsi?e.ateneo.ricerca.filtroListaCorsi:null,r.mostraCampoArea=!0,r.mostraCampoTipologia=!0,r.mostraCampoSede=!0,r.mostraCampoLingua=!0,r.filtroListaCorsi&&(r.mostraCampoArea=_.find(r.filtroListaCorsi,function(e){return"area"===e.nomeCampo}).visibile,r.mostraCampoTipologia=_.find(r.filtroListaCorsi,function(e){return"tipologia"===e.nomeCampo}).visibile,r.mostraCampoSede=_.find(r.filtroListaCorsi,function(e){return"sede"===e.nomeCampo}).visibile,r.mostraCampoLingua=_.find(r.filtroListaCorsi,function(e){return"linguaDiErogazione"===e.nomeCampo}).visibile),r.anno&&(r.aree=a.ricercaAreeTendina({anno:r.anno},function(e){r.aree=t.collection(e)}),r.gruppi=a.ricercaGruppiTendina({anno:r.anno},function(e){r.gruppi=t.collection(e)}),r.sedi=a.ricercaSediTendina({anno:r.anno},function(e){r.sedi=t.collection(e)}),r.lingue=a.ricercaLingueTendina({anno:r.anno},function(e){r.lingue=t.collection(e)}),r.params=i.get(),r.aa=e.year.label,r.open=!1,r.smallScreen=window.matchMedia("(max-width: 1023px)").matches,r.i18n=e.ateneo.i18n)},r.submit=function(){r.searching=!0,delete r.params.filter,o(function(){n.go(n.current,r.params,{reload:!0})}),r.smallScreen&&(r.open=!1)},r.$onDestroy=function(){c(),s(),l(),d(),u()};let c=e.$on("lang-changed",function(){t.collection(r.aree),t.collection(r.gruppi),t.collection(r.lingue),t.collection(r.sedi),r.i18n=e.ateneo.i18n}),s=e.$on("open-filters",function(){r.open=!0}),l=e.$on("close-filters",function(){r.open=!1}),d=e.$on("open-menu",function(){r.open=!1}),u=e.$on("search-complete",function(){r.searching=!1,r.smallScreen&&(r.open=!1)})}]}),catalogo.component("home",{templateUrl:"html/components/home.html",controller:["$rootScope","$state","$timeout","$location","META","LOCALIZE","AREE","GRUPPI",function(e,n,o,i,t,a,r,c){var s=this;s.nascondiDescrizione=!1,s.getData=function(){s.year=e.year.value;var n={anno:s.year};"gruppi"!==s.tipo&&"gruppi_piatti"!==s.tipo||(s.home=c.query(n,function(e){s.home=a.collection(e)})),"aree"===s.tipo&&(s.nascondiDescrizione=!0,s.home=r.query(n,function(e){s.home=a.collection(e)}))},s.setPageTitle=function(){e.$emit("pageTitle",{})},s.$onInit=function(){s.i18n=e.ateneo.i18n,s.tipo=e.ateneo.tipo_home,s.mostra_contatori_corsi=e.ateneo.mostra_contatori_corsi,s.getData(),s.localizeData(),s.ateneo=e.ateneo},s.accessibilityTitle=function(){return"gruppi"===e.ateneo.tipo_home||"gruppi_piatti"===e.ateneo.tipo_home?s.i18n.gruppi:s.i18n.aree},s.cardUrl=function(n){var o={anno:e.year.value,groupBy:s.tipo};return"gruppi"!==s.tipo&&"gruppi_piatti"!==s.tipo||(o.gruppo=n.cod),"aree"===s.tipo&&(o.area=n.cod),i.search().grafica&&(o.grafica=i.search().grafica),i.search().linguaCC&&(o.linguaCC=i.search().linguaCC),o},s.localizeData=function(){a.collection(s.home),s.setPageTitle(),t.setTitle("Course Catalogue")},s.$onDestroy=function(){d(),l()};let l=e.$on("year-changed",function(e,n){s.getData()}),d=e.$on("lang-changed",function(){s.localizeData()})}]}),catalogo.component("insegnamento",{templateUrl:"html/components/insegnamento.html",controller:["$rootScope","$state","$timeout","$location","META","STATEPARAMS","LOCALIZE","INSEGNAMENTO","CREA_PDF","CALENDARIO_UP",function(e,n,o,i,t,a,r,c,s,l){var d=this,u=r.lang();d.tooltipSviluppoSostenibile=e.CONST.obiettiviAgenda2030,d.visual_syll=parseInt(e.ateneo.visualizzazione_syllabus),d.dettaglioInsegnamento=e.ateneo.dettaglio_insegnamento,d.docenti_fittizi=e.ateneo.docenti_fittizi&&""!=e.ateneo.docenti_fittizi?e.ateneo.docenti_fittizi.split(",").map(function(e){return e.trim()}):[],d.annoPassato=function(e,n){var o=new Date,i=o.getMonth()>=5?o.getFullYear():o.getFullYear()-1;return n?e<=i:e<i},getTitle=function(e,n){return"it"==u||-1!==e.indexOf("2030 Agenda")?e+" "+n:n+" "+e},d.getCalendarioPubblicoUP=function(n){let o;o=n.data_inizio_periodo_didattico?new Date(n.data_inizio_periodo_didattico.substr(6,4)+"-"+n.data_inizio_periodo_didattico.substr(3,2)+"-"+n.data_inizio_periodo_didattico.substr(0,2)):new Date(n.corso_aa.substr(0,4)+"-"+e.ateneo.up.daData.substr(5,2)+"-"+e.ateneo.up.daData.substr(8,2)),o=moment(o).format("DD/MM/YYYY");let i="";n.fatPartCod&&n.domPartCod&&(i=n.fatPartCod+"\\"+n.domPartCod),d.configUP={annoRegolamento:parseInt(n.corso_aa),annoAccademico:n.aa+"",annoCorso:parseInt(n.corso_anno),codiceCorso:n.cdsCod,codicePercorso:n.af_percorso_cod,annoOrdinamento:parseInt(n.ordinamento_aa),codiceAF:n.adCod,codiceUD:n.udCod?n.udCod:"",fattorePartizione:n.fatPartCod?n.fatPartCod:"",partizione:i,dataInizio:o,lang:e.ateneo.up.lang,tipologieGuol:e.ateneo.up.tipologieGuol,vistaDefault:e.ateneo.up.vistaDefault,coloraPer:e.ateneo.up.coloraPer,mostraImpegniAnnullati:e.ateneo.up.mostraImpegniAnnullati,mostraPrimoDettaglio:e.ateneo.up.mostraPrimoDettaglio,switchRealeTemplate:e.ateneo.up.switchRealeTemplate,template:e.ateneo.up.template,tipoLink:"guide_online"};let t={payload:d.configUP,url:e.ateneo.up.url};l.calendarioPubblicoUP(t,function(e){console.log("Calendario pubblico UP creato: "),window.open(e.urlUP,"_blank")},function(e){console.log(e)})},d.$onInit=function(){d.i18n=e.ateneo.i18n,d.params=a.get(),d.state=n,d.stampa=e.ateneo.stampa_contenuti_corso;let o={anno:d.params.anno,insegnamento:decodeURIComponent(d.params.insegnamento),ordinamento_aa:d.params.ordinamento_aa,af_percorso:decodeURIComponent(d.params.af_percorso),corso_cod:decodeURIComponent(d.params.corso_cod)};i.search().coorte&&(o.corso_aa=i.search().coorte),i.search().schemaid&&(o.schema_id=i.search().schemaid),d.insegnamento=c.get(o,function(n){e.$emit("year-changed-secondary",{value:n.corso_aa.toString(),label:n.corso_aa+"/"+(parseInt(n.corso_aa)+1)}),n.mutuaDa&&(d.insegnamentoDaCuiMutua=c.get),n.moduli&&n.moduli.sort(function(e,n){return e.cod>n.cod}),n.frazioni&&(n.frazioni.sort(function(e,n){return e.cod>n.cod}),_.forEach(n.frazioni,function(e){e.docenti=n.docenti.filter(function(n){return n.domPartCod==e.domPartCod}),e.responsabili=n.responsabili.filter(function(n){return n.domPartCod==e.domPartCod}),e.totaleDocenti=_.uniqWith(_.concat(e.docenti,e.responsabili),_.isEqual)})),n.domPartCod&&(n.docenti=n.docenti.filter(function(e){return e.domPartCod==n.domPartCod}),n.responsabili=n.responsabili.filter(function(e){return e.domPartCod==n.domPartCod})),n.moduli&&n.moduli[0]&&n.moduli[0].frazioni&&n.moduli[0].frazioni.length>0&&_.each(n.moduli[0].frazioni,function(e,o){var i=_.filter(d.insegnamento.testiTotali,function(n){return n.chiave_cod&&n.chiave_cod.indexOf(e.cod)>-1});i[0]&&(i[0].altro_it||i[0].contenuti_it||i[0].metodi_didattici_est_it||i[0].obiettivi_formativi_it||i[0].prerequisiti_it||i[0].testi_it||i[0].verifica_apprendimento_it||i[0].altri_testi_1_it||i[0].altri_testi_2_it||i[0].altri_testi_3_it)&&(n.moduli[0].frazioni[o].mostra=!0)}),d.localizeData();var o=e.ateneo?e.ateneo.aa:[],i=Math.max.apply(Math,o.map(function(e){return e.value}));d.mostraPulsanteUP=function(){return!!(e.ateneo.up.url&&""!==e.ateneo.up.url&&e.ateneo.up.visibileDettaglioInsegnamento&&parseInt(n.aa)<=i)}},function(n){u=r.lang(),d.noPageTitle={nessunDato:!0},e.$emit("pageTitle",d.noPageTitle)}),i.search().grafica&&(d.grafica=i.search().grafica)},d.setPageTitle=function(){var e={title:"["+d.insegnamento.adCod+"] - "+d.insegnamento.des};if("B"===d.insegnamento.statoAttivita&&(e.nota=d.i18n.bozza+' <img class="img-icon-warning" title="'+d.i18n.attenzione+'" alt="'+d.i18n.attenzione+'" src="img/default/warning-15x13.gif">'),d.insegnamento.modulo_di&&(e.title="["+d.insegnamento.udCod+"] - "+d.insegnamento.des,e.subtitle=d.i18n.modulo_di,e.link={url:d.makeInsegnamentoUrl(d.insegnamento.aa,d.insegnamento.modulo_di.cod,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId),text:"["+d.insegnamento.adCod+"] - "+d.insegnamento.modulo_di.des}),d.insegnamento.frazione_di){let n=d.insegnamento.isPart&&d.insegnamento.isMod?d.insegnamento.udCod:d.insegnamento.adCod;e.title="["+d.insegnamento.udCod+"] - "+d.insegnamento.des,e.subtitle=d.i18n.frazione_di,e.link={url:d.makeInsegnamentoUrl(d.insegnamento.aa,d.insegnamento.frazione_di.cod,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId),text:"["+n+"] - "+d.insegnamento.frazione_di.des}}return e},d.localizeData=function(){let n=document.getElementById("scrollUpBtn");if(n.style.display="none",window.onscroll=function(){document.body.scrollTop>20||document.documentElement.scrollTop>20?n.style.display="block":n.style.display="none"},d.topFunction=function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},r.object(d.tooltipSviluppoSostenibile),d.insegnamento.$resolved){if(r.object(d.insegnamento),t.setTitle(d.insegnamento.des||d.i18n.attenzione),d.insegnamento.adFiglie&&d.insegnamento.adFiglie.length&&r.collection(d.insegnamento.adFiglie),d.insegnamento.adPadre&&r.object(d.insegnamento.adPadre),d.insegnamento.testiTotali&&d.insegnamento.testiTotali[0]){r.collection(d.insegnamento.testiTotali);for(let e of d.insegnamento.testiTotali)e.elenco_obiettivi_svil_sos&&e.elenco_obiettivi_svil_sos[0]&&r.collection(e.elenco_obiettivi_svil_sos),e.mod_elenco_obiettivi_svil_sos&&e.mod_elenco_obiettivi_svil_sos[0]&&r.collection(e.mod_elenco_obiettivi_svil_sos),e.altri_testi_ugov&&e.altri_testi_ugov[0]&&r.collection(e.altri_testi_ugov),e.mod_altri_testi_ugov&&e.mod_altri_testi_ugov[0]&&r.collection(e.mod_altri_testi_ugov),e.altri_testi&&e.altri_testi[0]&&r.collection(e.altri_testi),e.mod_altri_testi&&e.mod_altri_testi[0]&&r.collection(e.mod_altri_testi)}if(d.insegnamento.durata&&d.insegnamento.durata.tipo&&d.insegnamento.durata.tipo[0]&&r.collection(d.insegnamento.durata.tipo),d.insegnamento.moduli&&r.collection(d.insegnamento.moduli),d.insegnamento.frazioni&&r.collection(d.insegnamento.frazioni),d.insegnamento.modulo_di&&r.object(d.insegnamento.modulo_di),d.insegnamento.frazione_di&&r.object(d.insegnamento.frazione_di),d.insegnamento.moduli&&d.insegnamento.moduli[0]&&d.insegnamento.moduli[0].frazioni)for(let e of d.insegnamento.moduli)r.collection(e.frazioni);u=r.lang(),d.noPageTitle?e.$emit("pageTitle",d.noPageTitle):(e.$emit("pageTitle",d.setPageTitle()),d.makeAccordion())}},d.makeInsegnamentoUrl=function(e,o,i,t,a,r,c){var s={anno:e,insegnamento:o,ordinamento_aa:i,af_percorso:t,corso_cod:a,coorte:r,schemaid:c};return n.href("insegnamento",s)},d.makeCorsoLink=function(e,o,i,t){var a={anno:e,corso:o,annoOrdinamento:t,grafica:d.grafica};return'<a href="'+n.href("corso",a)+'">'+i+"</a>"},d.makePersonaLink=function(o,i,t,a,r,c){var s={docente:o,anno:t,grafica:d.grafica};return!(!d.insegnamento.modulo_di&&!d.insegnamento.frazione_di)&&c&&(i+=" ("+d.i18n.responsabile+")"),i?"AA"==e.ateneo.link_docente?i:"GG"==e.ateneo.link_docente?'<a href="'+n.href("docente",s)+'">'+i+"</a>":"TT"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":'<a href="'+n.href("docente",s)+'">'+i+"</a>":"PP"==e.ateneo.link_docente?e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",s)+'">'+i+"</a>":"TP"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",s)+'">'+i+"</a>":void 0:""},d.makeAccordion=function(){d.isRoot=!(!d.insegnamento||!d.insegnamento.cod||-1!==d.insegnamento.cod.indexOf("-")),d.isMod=d.insegnamento.isMod,d.isPart=d.insegnamento.isPart,d.hasModuli=d.insegnamento.moduli&&d.insegnamento.moduli.length>0,d.hasFrazioni=d.insegnamento.frazioni&&d.insegnamento.frazioni.length>0,d.isModulo=!!d.insegnamento.modulo_di,d.isFrazione=!!d.insegnamento.frazione_di,d.testi={insegnamento:{},modulo:{},frazione:{}},d.testi.insegnamento=_.find(d.insegnamento.testiTotali,function(e){return!e.chiave_cod}),d.isModulo&&(d.testi.modulo=_.find(d.insegnamento.testiTotali,function(e){return e.chiave_cod===d.insegnamento.cod})),d.isFrazione&&(d.testi.modulo=_.find(d.insegnamento.testiTotali,function(e){return e.chiave_cod===d.insegnamento.cod}),d.testi.frazione=_.find(d.insegnamento.testiTotali,function(e){return e.chiave_cod===d.insegnamento.cod}));try{if(d.accordion=[{title:d.i18n.info_generali,type:"list",body:[],open:!0}],d.insegnamento.corso_aa&&d.insegnamento.corso_cod&&d.insegnamento.corso_des&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.corso"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.corso,value:d.makeCorsoLink(d.insegnamento.corso_aa,d.insegnamento.corso_cod,d.insegnamento.corso_des,d.insegnamento.ordinamento_aa)}),d.insegnamento.aa&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.annoofferta"===e.nomeCampo}).visibile){var e=d.insegnamento.aa;isNaN(parseInt(e))||(e=e+"/"+(parseInt(e)+1)),d.accordion[0].body.push({label:d.i18n.annoofferta,value:e})}if(d.insegnamento.corso_anno&&0!==parseInt(d.insegnamento.corso_anno)&&"altreAttivita"!==d.insegnamento.corso_anno&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.anno_di_corso"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.anno_di_corso,value:d.insegnamento.corso_anno+""}),d.insegnamento.annoCorsoAnticipo&&null!==d.insegnamento.annoCorsoAnticipo&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.anno_corso_anticipo"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.insegnamento_anticipabile,value:d.i18n.dall_anno+" "+d.insegnamento.annoCorsoAnticipo}),d.insegnamento.tipo&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipologia"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipologia,value:d.insegnamento.tipo}),d.insegnamento.intercla_tipo&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipologia"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipologia_interclasse,value:d.insegnamento.intercla_tipo}),d.insegnamento.lingua_des&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.lingua"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.lingua,value:d.insegnamento.lingua_des}),d.insegnamento.crediti&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.crediti"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.crediti_insegnamento,value:d.insegnamento.crediti+" "+d.i18n.cfu_insegnamento}),d.insegnamento.metodi_didattici&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipo_attivita_didattica"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipo_attivita_didattica,value:d.insegnamento.metodi_didattici}),d.insegnamento.tipoEsaCod&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipo_esame"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipo_esame||"Tipo esame",value:d.insegnamento.tipoEsaDes}),d.insegnamento.valutazione&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.valutazione"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.valutazione,value:d.insegnamento.valutazione}),d.insegnamento.periodo_didattico&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.periodo_didattico"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.periodo_didattico,value:d.insegnamento.periodo_didattico}),d.insegnamento.tipo_ins_cod&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipo_insegnamento"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipo_insegnamento,value:d.insegnamento.tipo_ins_des}),d.isFrazione&&d.accordion[0].body.splice(5,1),d.insegnamento.titolari&&d.insegnamento.titolari.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile){d.insegnamento.titolari=_.filter(d.insegnamento.titolari,function(e){return!d.docenti_fittizi.includes(e.matricola)});var n=[];d.insegnamento.titolari=_.uniqBy(d.insegnamento.titolari,"des");for(let e of d.insegnamento.titolari)n.push(d.makePersonaLink(e.cod,e.des,e.aa,e.matricola,e.hyperlink,e.respDidFlg));d.accordion[0].body.push({label:d.i18n.titolari,value:n.join(", ")})}if(d.insegnamento.responsabili&&d.insegnamento.responsabili.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.responsabili"===e.nomeCampo}).visibile){d.insegnamento.responsabili=_.filter(d.insegnamento.responsabili,function(e){return!d.docenti_fittizi.includes(e.matricola)});let e=[];if(d.insegnamento.responsabili=_.uniqBy(d.insegnamento.responsabili,"des"),d.insegnamento.titolari&&d.insegnamento.titolari.length>0)_.map(d.insegnamento.responsabili,function(n){_.find(d.insegnamento.titolari,function(e){return e.cod===n.cod})&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile||e.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg))}),e.length>0&&d.accordion[0].body.push({label:d.i18n.responsabili,value:e.join(", ")});else{for(let n of d.insegnamento.responsabili)e.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg));d.accordion[0].body.push({label:d.i18n.responsabili,value:e.join(", ")})}}if(d.insegnamento.docenti&&d.insegnamento.docenti.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.docenti"===e.nomeCampo}).visibile){d.insegnamento.docenti=_.filter(d.insegnamento.docenti,function(e){return!d.docenti_fittizi.includes(e.matricola)});let e=[];d.insegnamento.docenti=_.uniqBy(d.insegnamento.docenti,"des"),_.map(d.insegnamento.docenti,function(n){let o=!1,i=!1;d.insegnamento.titolari&&d.insegnamento.titolari.length>0&&(o=_.find(d.insegnamento.titolari,function(e){return e.cod===n.cod})),d.insegnamento.responsabili&&d.insegnamento.responsabili.length>0&&(i=_.find(d.insegnamento.responsabili,function(e){return e.cod===n.cod})),!(d.insegnamento.titolari&&d.insegnamento.titolari.length>0&&(!o||!_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile)&&d.insegnamento.responsabili&&d.insegnamento.responsabili.length>0)||i&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.responsabili"===e.nomeCampo}).visibile||e.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg))}),e.length>0&&d.accordion[0].body.push({label:d.i18n.docenti,value:e.join(", ")}),d.insegnamento.titolari&&0!==d.insegnamento.titolari.length||d.insegnamento.responsabili&&0!==d.insegnamento.responsabili.length||(_.map(d.insegnamento.docenti,function(n){e.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg))}),d.accordion[0].body.push({label:d.i18n.docenti,value:e.join(", ")}))}if(d.insegnamento.corso_percorso_id&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.percorso"===e.nomeCampo}).visibile&&d.accordion[0].body.splice(1,0,{label:d.i18n.percorso,value:d.makeCorsoLink(d.insegnamento.corso_aa,d.insegnamento.corso_cod,d.insegnamento.corso_percorso_des,d.insegnamento.ordinamento_aa)}),d.insegnamento.durata&&d.insegnamento.durata.totale&&!d.isFrazione&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.durata"===e.nomeCampo}).visibile){let e="";if(d.insegnamento.durata.tipo&&d.insegnamento.durata.tipo.length>0){for(let n of d.insegnamento.durata.tipo)e+=n.valore+" "+d.i18n.ore+" "+n.tipo_durata_des+", ";e=e.substring(0,e.length-2)}d.accordion[0].body.push({label:d.i18n.durata,value:d.insegnamento.durata.totale+" "+d.i18n.ore+" ("+e+")"})}if(d.insegnamento.frequenza&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.frequenza"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.frequenza,value:d.insegnamento.frequenza}),d.insegnamento.ssd&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.ssd"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.ssd,value:d.insegnamento.ssd}),d.insegnamento.sede_des&&!d.hasFrazioni&&!d.hasModuli&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.sede"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.sede,value:d.insegnamento.sede_des}),d.insegnamento.adPadre&&d.insegnamento.adPadre.adCod&&d.accordion[0].body.push({label:d.i18n.attivita_principale,value:"<a href='"+d.makeInsegnamentoUrl(d.insegnamento.adPadre.aaOffId,d.insegnamento.adPadre.adId,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId)+"'>["+d.insegnamento.adPadre.adCod+"] - "+d.insegnamento.adPadre.adDes+"</a>"}),d.insegnamento.adFiglie&&d.insegnamento.adFiglie.length>0){let e=[];for(let n of d.insegnamento.adFiglie)e.push("<a href='"+d.makeInsegnamentoUrl(n.aaOffId,n.adId,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId)+"'>["+n.adCod+"] - "+n.adDes+"</a>");d.accordion[0].body.push({label:d.i18n.attivita_correlate,value:e.join("<br>")})}function o(e){if(e){if(e.elenco_obiettivi_svil_sos&&e.elenco_obiettivi_svil_sos.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_svil_sos"===e.nomeCampo}).visibileSuInsegnamento){d.accordion.push({title:getTitle(d.i18n.obiettivi_svil_sos,""),type:"text",body:(e.obiettivi_svil_sos_des||"").replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," "),id:"svil_sos"});let n=_.find(d.accordion,function(e){return"svil_sos"===e.id});n.body+="<br/>";for(let o of e.elenco_obiettivi_svil_sos){let e=((o=o.trim())&&1===o.length?"0":"")+""+o,i=d.tooltipSviluppoSostenibile["icon"+e];n.body+='<img title="'+i+'" class="icon" style="max-width: 150px;margin: 15px;" src="/img/obiettiviAgenda2030/SDG-icon-'+u.toUpperCase()+"-RGB-"+e+'.jpg">'}}if(e.obiettivi_formativi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_formativi"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.obiettivi_formativi,""),type:"text",body:e.obiettivi_formativi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.prerequisiti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.prerequisiti"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.prerequisiti,""),type:"text",body:e.prerequisiti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.contenuti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.contenuti"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.contenuti,""),type:"text",body:e.contenuti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.metodi_didattici_est&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.metodi_didattici_est"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.metodi_didattici_est,""),type:"text",body:e.metodi_didattici_est.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.verifica_apprendimento&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.verifica_apprendimento"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.verifica_apprendimento,""),type:"text",body:e.verifica_apprendimento.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.testi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.testi"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.testi,""),type:"text",body:e.testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_1&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.altri_testi_1,""),type:"text",body:e.altri_testi_1.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_2&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.altri_testi_2,""),type:"text",body:e.altri_testi_2.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_3&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.altri_testi_3,""),type:"text",body:e.altri_testi_3.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_ugov&&e.altri_testi_ugov.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi_ugov"===e.nomeCampo}).visibileSuInsegnamento)for(let n=0;n<e.altri_testi_ugov.length;n++){let o=e.altri_testi_ugov[n];d.accordion.push({title:getTitle(o.ugov_etichetta,""),type:"text",body:o.ugov_altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}if(e.altri_testi&&e.altri_testi.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuInsegnamento)for(let n=0;n<e.altri_testi.length;n++){let o=e.altri_testi[n];d.accordion.push({title:getTitle(o.etichetta,""),type:"text",body:o.altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}e.altro&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altro"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.altro,""),type:"text",body:e.altro.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.testi_biblio&&""!==e.testi_biblio&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.testi_biblio"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.testi_biblio,""),type:"text",body:e.testi_biblio.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.programmazione_estesa&&""!==e.programmazione_estesa&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.programmazione_estesa"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.programmazione_estesa,""),type:"text",body:e.programmazione_estesa.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.risorse_online&&""!==e.risorse_online&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.risorse_online"===e.nomeCampo}).visibileSuInsegnamento&&d.accordion.push({title:getTitle(d.i18n.risorse_online,""),type:"text",body:e.risorse_online.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}}function i(e){if(addon=" "+d.i18n.del_modulo,e.mod_elenco_obiettivi_svil_sos&&e.mod_elenco_obiettivi_svil_sos.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_svil_sos"===e.nomeCampo}).visibileSuModulo){d.accordion.push({title:getTitle(d.i18n.obiettivi_svil_sos,addon),type:"text",body:e.mod_obiettivi_svil_sos_des.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," "),id:"svil_sos_mod"});let n=_.find(d.accordion,function(e){return"svil_sos_mod"===e.id});n.body+="<br/>";for(let o of e.mod_elenco_obiettivi_svil_sos){let e=((o=o.trim())&&1===o.length?"0":"")+""+o,i=d.tooltipSviluppoSostenibile["icon"+e];n.body+='<img title="'+i+'" class="icon" style="max-width: 150px;margin: 15px;" src="/img/obiettiviAgenda2030/SDG-icon-'+u.toUpperCase()+"-RGB-"+e+'.jpg">'}}if(e.mod_obiettivi_formativi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_formativi"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.obiettivi_formativi,addon),type:"text",body:e.mod_obiettivi_formativi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_prerequisiti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.prerequisiti"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.prerequisiti,addon),type:"text",body:e.mod_prerequisiti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_contenuti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.contenuti"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.contenuti,addon),type:"text",body:e.mod_contenuti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_metodi_didattici_est&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.metodi_didattici_est"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.metodi_didattici_est,addon),type:"text",body:e.mod_metodi_didattici_est.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_verifica_apprendimento&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.verifica_apprendimento"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.verifica_apprendimento,addon),type:"text",body:e.mod_verifica_apprendimento.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_testi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.testi"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.testi,addon),type:"text",body:e.mod_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_altri_testi_1&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.altri_testi_1,addon),type:"text",body:e.mod_altri_testi_1.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_altri_testi_2&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.altri_testi_2,addon),type:"text",body:e.mod_altri_testi_2.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_altri_testi_3&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.altri_testi_3,addon),type:"text",body:e.mod_altri_testi_3.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.mod_altri_testi_ugov&&e.mod_altri_testi_ugov.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi_ugov"===e.nomeCampo}).visibileSuModulo)for(let n=0;n<e.mod_altri_testi_ugov.length;n++){let o=e.mod_altri_testi_ugov[n];d.accordion.push({title:getTitle(o.ugov_etichetta,addon),type:"text",body:o.ugov_altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}if(e.mod_altri_testi&&e.mod_altri_testi.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuModulo)for(let n=0;n<e.mod_altri_testi.length;n++){let o=e.mod_altri_testi[n];d.accordion.push({title:getTitle(o.etichetta,addon),type:"text",body:o.altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}e.mod_altro&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altro"===e.nomeCampo}).visibileSuModulo&&d.accordion.push({title:getTitle(d.i18n.altro,addon),type:"text",body:e.mod_altro.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}function t(e){if(addon=" "+d.i18n.della_partizione,e.elenco_obiettivi_svil_sos&&e.elenco_obiettivi_svil_sos.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_svil_sos"===e.nomeCampo}).visibileSuPartizione){d.accordion.push({title:getTitle(d.i18n.obiettivi_svil_sos,addon),type:"text",body:e.obiettivi_svil_sos_des.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," "),id:"svil_sos_fraz2"});let n=_.find(d.accordion,function(e){return"svil_sos_fraz2"===e.id});n.body+="<br/>";for(let o of e.elenco_obiettivi_svil_sos){let e=((o=o.trim())&&1===o.length?"0":"")+""+o,i=d.tooltipSviluppoSostenibile["icon"+e];n.body+='<img title="'+i+'" class="icon" style="max-width: 150px;margin: 15px;" src="/img/obiettiviAgenda2030/SDG-icon-'+u.toUpperCase()+"-RGB-"+e+'.jpg">'}}if(e.obiettivi_formativi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.obiettivi_formativi"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.obiettivi_formativi+" "+addon,type:"text",body:e.obiettivi_formativi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.prerequisiti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.prerequisiti"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.prerequisiti+" "+addon,type:"text",body:e.prerequisiti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.contenuti&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.contenuti"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.contenuti+" "+addon,type:"text",body:e.contenuti.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.metodi_didattici_est&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.metodi_didattici_est"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.metodi_didattici_est+" "+addon,type:"text",body:e.metodi_didattici_est.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.verifica_apprendimento&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.verifica_apprendimento"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.verifica_apprendimento+" "+addon,type:"text",body:e.verifica_apprendimento.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.testi&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.testi"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.testi+" "+addon,type:"text",body:e.testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_1&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.altri_testi_1+" "+addon,type:"text",body:e.altri_testi_1.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_2&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.altri_testi_2+" "+addon,type:"text",body:e.altri_testi_2.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_3&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.altri_testi_3+" "+addon,type:"text",body:e.altri_testi_3.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.altri_testi_ugov&&e.altri_testi_ugov.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi_ugov"===e.nomeCampo}).visibileSuPartizione)for(let n=0;n<e.altri_testi_ugov.length;n++){let o=e.altri_testi_ugov[n];d.accordion.push({title:o.ugov_etichetta+" "+addon,type:"text",body:o.ugov_altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}if(e.altri_testi&&e.altri_testi.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altri_testi"===e.nomeCampo}).visibileSuPartizione)for(let n=0;n<e.altri_testi.length;n++){let o=e.altri_testi[n];d.accordion.push({title:o.etichetta+" "+addon,type:"text",body:o.altri_testi.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}e.altro&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.altro"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.altro+" "+addon,type:"text",body:e.altro.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.testi_biblio&&""!==e.testi_biblio&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.testi_biblio"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.testi_biblio+" "+addon,type:"text",body:e.testi_biblio.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.programmazione_estesa&&""!==e.programmazione_estesa&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.programmazione_estesa"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.programmazione_estesa+" "+addon,type:"text",body:e.programmazione_estesa.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")}),e.risorse_online&&""!==e.risorse_online&&_.find(d.dettaglioInsegnamento,function(e){return"testiSyllabus.risorse_online"===e.nomeCampo}).visibileSuPartizione&&d.accordion.push({title:d.i18n.risorse_online+" "+addon,type:"text",body:e.risorse_online.replace(/(\r\n|\n|\r)/gm,"<br />").replace(/\s+/g," ")})}d.visual_syll?d.isMod||d.isPart?d.isMod&&!d.isPart?(d.isModulo||d.isFrazione||o(d.testi.insegnamento),d.isModulo&&!d.isFrazione&&i(d.testi.modulo)):d.isMod&&d.isPart?d.isModulo&&!d.isFrazione?(i(d.testi.modulo),"N0"==d.testi.modulo.chiave_domPartCod&&t(d.testi.modulo)):!d.isModulo&&d.isFrazione&&t(d.testi.frazione):!d.isMod&&d.isPart&&!d.isModulo&&d.isFrazione&&t(d.testi.frazione):o(d.testi.insegnamento):d.isMod||d.isPart?d.isMod&&!d.isPart?d.isModulo&&!d.isFrazione&&(o(d.testi.insegnamento),i(d.testi.modulo)):d.isMod&&d.isPart?(!d.isModulo&&d.isFrazione&&(i(d.testi.modulo),t(d.testi.frazione)),"N0"==d.testi.modulo.chiave_domPartCod&&d.isModulo&&!d.isFrazione&&(i(d.testi.modulo),t(d.testi.modulo))):!d.isMod&&d.isPart&&!d.isModulo&&d.isFrazione&&t(d.testi.frazione):o(d.testi.insegnamento)}catch(e){console.log("Errore durante la creazione dell'accordion dell'insegnamento",e)}},d.makeAccordionPDF=function(e){try{var n=[{title:d.i18n.info_generali,type:"list",body:[]}];if(e.corso_aa&&e.corso_cod&&e.corso_des&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.corso"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.corso,value:d.makeCorsoLink(e.corso_aa,e.corso_cod,e.corso_des,e.ordinamento_aa)}),e.aa&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.annoofferta"===e.nomeCampo}).visibile){var o=e.aa;isNaN(parseInt(o))||(o=o+"/"+(parseInt(o)+1)),n[0].body.push({label:d.i18n.annoofferta,value:o})}if(e.corso_anno&&0!==parseInt(e.corso_anno)&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.anno_di_corso"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.anno_di_corso,value:e.corso_anno+""}),e.annoCorsoAnticipo&&null!==e.annoCorsoAnticipo&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.anno_corso_anticipo"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.insegnamento_anticipabile,value:d.i18n.dall_anno+" "+e.annoCorsoAnticipo}),e.tipo&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipologia"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.tipologia,value:e.tipo}),e.crediti&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.crediti"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.crediti_insegnamento,value:e.crediti+" "+d.i18n.cfu_insegnamento}),e.metodi_didattici&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipo_attivita_didattica"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.tipo_attivita_didattica,value:e.metodi_didattici}),d.insegnamento.tipo_ins_cod&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.tipo_insegnamento"===e.nomeCampo}).visibile&&d.accordion[0].body.push({label:d.i18n.tipo_insegnamento,value:d.insegnamento.tipo_ins_des}),e.durata&&e.durata.totale&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.durata"===e.nomeCampo}).visibile){let o="";if(e.durata.tipo&&e.durata.tipo.length>0){for(let n of e.durata.tipo)o+=n.valore+" "+d.i18n.ore+" "+n.tipo_durata_des+", ";o=o.substring(0,o.length-2)}n[0].body.push({label:d.i18n.durata,value:e.durata.totale+" "+d.i18n.ore+" ("+o+")"})}if(e.ssd&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.ssd"===e.nomeCampo}).visibile&&n[0].body.push({label:d.i18n.ssd,value:e.ssd}),e.titolari&&e.titolari.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile){var i=[];d.insegnamento.titolari=_.uniqBy(d.insegnamento.titolari,"des");for(let n of e.titolari)i.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg));n[0].body.push({label:d.i18n.titolari,value:i.join(", ")})}if(e.responsabili&&e.responsabili.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.responsabili"===e.nomeCampo}).visibile){let o=[];if(d.insegnamento.responsabili=_.uniqBy(d.insegnamento.responsabili,"des"),e.titolari&&e.titolari.length>0)_.map(e.responsabili,function(n){_.find(e.titolari,function(e){return e.cod===n.cod})&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile||o.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg))}),o.length>0&&n[0].body.push({label:d.i18n.responsabili,value:o.join(", ")});else{for(let n of e.responsabili)o.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg));n[0].body.push({label:d.i18n.responsabili,value:o.join(", ")})}}if(e.docenti&&e.docenti.length>0&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.docenti"===e.nomeCampo}).visibile){let o=[];d.insegnamento.docenti=_.uniqBy(d.insegnamento.docenti,"des"),_.map(e.docenti,function(n){let i=!1,t=!1;e.titolari&&e.titolari.length>0&&(i=_.find(e.titolari,function(e){return e.cod===n.cod})),e.responsabili&&e.responsabili.length>0&&(t=_.find(e.responsabili,function(e){return e.cod===n.cod})),!(e.titolari&&e.titolari.length>0&&(!i||!_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.titolari"===e.nomeCampo}).visibile)&&e.responsabili&&e.responsabili.length>0)||t&&_.find(d.dettaglioInsegnamento,function(e){return"informazioniGenerali.responsabili"===e.nomeCampo}).visibile||o.push(d.makePersonaLink(n.cod,n.des,n.aa,n.matricola,n.hyperlink,n.respDidFlg))}),o.length>0&&n[0].body.push({label:d.i18n.docenti,value:o.join(", ")}),e.titolari&&0!==e.titolari.length||e.responsabili&&0!==e.responsabili.length||(_.map(e.docenti,function(e){o.push(d.makePersonaLink(e.cod,e.des,e.aa,e.matricola,e.hyperlink,e.respDidFlg))}),n[0].body.push({label:d.i18n.docenti,value:o.join(", ")}))}return n}catch(e){console.log("Errore durante la creazione dell'accordion dell'insegnamento",e)}},d.$onDestroy=function(){m()};let m=e.$on("lang-changed",function(){d.localizeData()});d.pdf=function(){var n="report "+d.insegnamento.des_it+".pdf",o={ateneo:e.ateneo.des,logoimg:"/img/"+e.ateneo.ate_cod+"/logoreport.png",atecod:e.ateneo.ate_cod,insegnamento:"["+d.insegnamento.adCod+"] "+d.insegnamento.des,accordion:d.accordion,moduli_label:"",moduli:[]};if(d.insegnamento.moduli&&d.insegnamento.moduli.length>0){o.moduli_label=d.i18n.scelta_modulo;for(let[e,n]of d.insegnamento.moduli.entries()){var i=d.makeInsegnamentoUrl(d.insegnamento.aa,n.cod,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId),t="["+d.insegnamento.adCod+"] "+n.des,a={titolo_modulo:e+1+". "+t,titolo_modulo_link:' <a href="'+i+'">'+t+"</a>",accordion_modulo:d.makeAccordionPDF(n),frazioni_label:"",frazioni:[]};if(n.frazioni&&n.frazioni.length>0){a.frazioni_label=d.i18n.scelta_frazione;for(let e of n.frazioni){var r=d.makeInsegnamentoUrl(d.insegnamento.aa,e.cod,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId),c={titolo_frazione:l="["+d.insegnamento.adCod+"] "+e.des,titolo_frazione_link:' <a href="'+r+'">'+l+"</a>"};a.frazioni.push(c)}}o.moduli.push(a)}}if(o.frazioni_label="",o.frazioni=[],d.insegnamento.frazioni&&d.insegnamento.frazioni.length>0){o.frazioni_label=d.i18n.scelta_frazione;for(let e of d.insegnamento.frazioni){var l;r=d.makeInsegnamentoUrl(d.insegnamento.aa,e.cod,d.insegnamento.ordinamento_aa,d.insegnamento.af_percorso_id,d.insegnamento.corso_cod,d.insegnamento.corso_aa,d.insegnamento.schemaId),c={titolo_frazione:l="["+d.insegnamento.adCod+"] "+e.des,titolo_frazione_link:' <a href="'+r+'">'+l+"</a>"};o.frazioni.push(c)}}o.sottotitolo="";var u=d.setPageTitle();u.link&&(o.sottotitolo=u.subtitle+' <a href="'+u.link.url+'">'+u.link.text+"</a>"),s.create(n,"client/html/template/templatePdf.html",o)},d.teledidattica=function(e){"http"===e.substring(0,e.indexOf(":"))||"https"===e.substring(0,e.indexOf(":"))?window.open(e,"_blank"):window.open("http://"+e,"_blank")}}]}),catalogo.component("listaDocenti",{templateUrl:"html/components/lista-docenti.html",controller:["$rootScope","$state","$location","META","STATEPARAMS","LOCALIZE","CORSO","LISTA_DOCENTI",function(e,n,o,i,t,a,r,c){var s=this;s.getData=function(){c.query(s.params,function(n){s.docenti=n,s.localizeData(),_.each(s.docenti,function(e){e.linkHTML=s.makePersonaLink(e.cod,e.des,e.aa,e.matricola,e.hyperlink)}),e.results=s.docenti})},s.$onInit=function(){s.i18n=e.ateneo.i18n,s.params=t.get(),s.getData(),s.smallScreen=window.matchMedia("(max-width: 1023px)").matches,s.corso=r.get({anno:s.params.anno,corso:s.params.corso_cod,annoOrdinamento:s.params.annoOrdinamento},function(e){s.localizeData()},function(e){s.noPageTitle={nessunDato:!0}}),o.search().grafica&&(s.grafica=o.search().grafica)},s.setPageTitle=function(){let n=s.i18n.docenti_corso;e.$emit("pageTitle",{title:n,nota:s.i18n.nota_lista_docenti}),i.setTitle(n)},s.localizeData=function(){s.corso&&s.corso.$resolved&&a.object(s.corso),s.docenti&&s.docenti.length>0&&s.docenti.forEach(function(e){a.object(e)}),s.setPageTitle()},s.$onDestroy=function(){l()};let l=e.$on("lang-changed",function(){s.localizeData()});s.makePersonaLink=function(o,i,t,a,r){var c={docente:o,anno:t,grafica:s.grafica};return i?"AA"==e.ateneo.link_docente?i:"GG"==e.ateneo.link_docente?'<a href="'+n.href("docente",c)+'">'+i+"</a>":"TT"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":"PP"==e.ateneo.link_docente?e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":"TP"==e.ateneo.link_docente?r?'<a target="_blank" href="'+r+'">'+i+"</a>":e.ateneo.link_docente_pp?'<a target="_blank" href="'+e.ateneo.link_docente_pp.replace("#docenteid#",a)+'">'+i+"</a>":'<a href="'+n.href("docente",c)+'">'+i+"</a>":void 0:""}}]}),catalogo.component("masthead",{templateUrl:"html/components/masthead.html",controller:["$rootScope","$state","$transitions","$location","localStorageService","ANNI_OFFERTA",function(e,n,o,i,t,a){var r=this,c=n.params.anno;r.$onInit=function(){if(r.open=!1,r.years=e.ateneo.aa,c>r.years[0].value&&(c=r.years[0].value),c)c&&n.params.docente?r.years=a.get(function(e){e=Object.values(e),r.year=_.find(r.years,function(e){return e.value===c}),r.changeYear(!1)}):(r.year=_.find(r.years,function(e){return e.value===c}),r.changeYear(!1));else if(n.params.coorte)r.year=t.get("year")?_.find(r.years,function(e){return e.value===n.params.coorte}):r.years[0],r.changeYear(!0);else{let n=e.ateneo.data_anno_default.substr(8,2)+"/"+e.ateneo.data_anno_default.substr(5,2),o=new Date((new Date).getUTCFullYear()+"-"+n.split("/")[1]+"-"+n.split("/")[0]+"T22:00:00.000Z"),i=!1;new Date>=o?(new Date).getUTCFullYear()>=_.toInteger(r.years[0].value)&&(i=!0):(new Date).getUTCFullYear()>_.toInteger(r.years[0].value)&&(i=!0);let a=i?r.years[0]:r.years[1];r.year=t.get("year")?_.find(r.years,function(e){return e.value===t.get("year")}):a,r.changeYear(!0)}r.$state=n,r.i18n=e.ateneo.i18n,r.mostraGrafica=!0,i.search().grafica&&"off"==i.search().grafica&&(r.mostraGrafica=!1)},r.openMenu=function(){e.$broadcast("open-menu"),document.body.style.overflow="hidden",document.body.style.height=window.innerHeight+"px",e.$emit("close-filters")},r.closeMenu=function(){e.$broadcast("close-menu"),document.body.style.overflow="visible",document.body.style.height="auto"},r.toggleMenu=function(){r.open=!r.open,!1===r.open?r.closeMenu():r.openMenu()},r.changeLang=function(n){e.$emit("lang-changed",n),r.open=!1,r.lang=n},r.changeYear=function(n){e.year=r.year,n&&e.$emit("year-changed",r.year)},o.onStart({},function(){r.open=!1,r.closeMenu()}),o.onSuccess({},function(){n.params.anno&&n.params.docente&&(r.year=_.find(r.years,function(e){return e.value===n.params.anno})?_.find(r.years,function(e){return e.value===n.params.anno}):_.maxBy(r.years,function(e){return parseInt(e.value)}),r.changeYear(!1))}),r.$onDestroy=function(){s(),l(),d()};let s=e.$on("lang-changed",function(n,o){r.lang=o,r.logo="/img/"+e.ateneo.ate_cod+"/logo.png",r.logocoucat="/img/"+e.ateneo.ate_cod+"/logocoucat.png",r.background="/img/"+e.ateneo.ate_cod+"/background.png",r.i18n=e.ateneo.i18n,r.ate_des=e.ateneo.des,r.ate_cod=e.ateneo.ate_cod}),l=e.$on("year-changed",function(e,n){t.set("year",n.value)}),d=e.$on("year-changed-secondary",function(e,n){r.year=n,r.changeYear(!1)})}]}),catalogo.component("modal",{templateUrl:"html/components/modal.html",transclude:!0,bindings:{open:"=",title:"@",dismissable:"="},controller:["$rootScope","META",function(e,n){var o=this;o.$onChanges=function(){o.open?(e.lockedBody=!0,e.$emit("modal-open"),n.setTitle(o.title),o.oldLocation=e.oldLocation):e.$emit("modal-close")},o.close=function(){o.open=!1,e.$emit("modal-close")},o.$onDestroy=function(){i()};let i=e.$on("modal-close",function(){o.open=!1,e.lockedBody=!1});o.back=function(){console.log(e)}}]}),catalogo.component("noResults",{templateUrl:"html/components/no-results.html",bindings:{testo:"<"}}),catalogo.component("pageTitle",{templateUrl:"html/components/page-title.html",controller:["$rootScope",function(e){var n=this;n.setTitle=function(o){o.nessunDato?(n.i18n=e.ateneo.i18n,n.title=n.i18n.attenzione,n.nota="",o.paginaDocente?n.subtitle=n.i18n.nessun_contenuto_anno_offerta:n.subtitle=n.i18n.nessunContenuto):(n.title=o.title,n.subtitle=o.subtitle,n.link=o.link,n.nota=o.nota)},n.$onDestroy=function(){o()};let o=e.$on("pageTitle",function(e,o){n.setTitle(o)})}]}),catalogo.component("paginaNonRaggiungibile",{templateUrl:"html/components/paginaNonRaggiungibile.html",controller:["$rootScope","STATEPARAMS","META",function(e,n,o){var i=this;i.$onInit=function(){i.params=n.get(),i.i18n=e.ateneo.i18n,i.params&&i.params.urlSbagliato&&(i.urlSbagliato=i.params.urlSbagliato),i.params&&i.params.urlSbagliatoRedirect&&(i.urlSbagliatoRedirect=i.params.urlSbagliatoRedirect),o.setTitle(i.i18n.attenzione||i.i18n.attenzione_it)}}]}),catalogo.component("secondaryMenu",{templateUrl:"html/components/secondary-menu.html",controller:["$rootScope","$state",function(e,n){var o=this;o.visualizzazione_link_estesa=!_.isNil(e.ateneo.visualizzazione_link_estesa)&&e.ateneo.visualizzazione_link_estesa,o.$onInit=function(){o.open=o.visualizzazione_link_estesa,o.i18n=e.ateneo.i18n},o.buttonTitle=function(){return o.open?"chiudiMenu":"apriMenu"},o.toggleMenu=function(){o.open=!o.open},o.$onDestroy=function(){i()};let i=e.$on("lang-changed",function(){o.links=e.ateneo.link,o.i18n=e.ateneo.i18n})}]}),catalogo.component("tabs",{templateUrl:"html/components/tabs.html",bindings:{tabs:"="},controller:function(){var e=this;e.setActive=function(n){e.tabs.forEach(function(e,o){e.active=n===o})}}});